'use strict';const a20_0x38d0=['from','viewAxisInWorld','bInvertRot','1620665zflnzK','fFOVInRadian','fAspect','1201971ybmMlI','fSensPanP','bDragging','makeAxis','rotateX','fSensPanO','mProjI','fWidth','1ElTnAx','ePerspective','eControl','9oxWXDK','sign','1140598fqwRol','rotateY','desc','setOrthographic','1554996cFXmxI','add','vDragPoint','mul','vEye','eAxisX','328191QsUirv','fSensRot','vAt','translation','make','distance','eProjType','eLockAxis','fHeight','vUp','72415adlcKm','fSensZoomO','negate','screenToClipV','dot','assign','boundsScene','1nWxXMl','transformPoint3','rotateZ','eAxisY','1895602LGbhEY','setViewParam','viewport','transformVec3','fNear','rotate','camera','eAxisZ'];(function(_0x3418c1,_0x47ff17){const _0x13085a=a20_0x1ad3;while(!![]){try{const _0x4fb8b6=-parseInt(_0x13085a(0xef))+parseInt(_0x13085a(0xfa))*-parseInt(_0x13085a(0xe4))+-parseInt(_0x13085a(0xf2))*-parseInt(_0x13085a(0xe0))+-parseInt(_0x13085a(0xd9))+parseInt(_0x13085a(0x103))+-parseInt(_0x13085a(0xff))+-parseInt(_0x13085a(0x109))*-parseInt(_0x13085a(0xfd));if(_0x4fb8b6===_0x47ff17)break;else _0x3418c1['push'](_0x3418c1['shift']());}catch(_0x1f8d13){_0x3418c1['push'](_0x3418c1['shift']());}}}(a20_0x38d0,0xef99e));import*as a20_0x5b02b2 from'../Math/math.js';import*as a20_0x16af57 from'../Math/float2.js';import*as a20_0x4eb301 from'../Math/float3.js';import*as a20_0x3e4ce6 from'../Math/matrix.js';import*as a20_0x5dc102 from'../Math/box.js';import*as a20_0x532720 from'./camera.js';export const eZoom=0x0;export const ePan=0x1;export const eRotPos=0x2;export const eRotDir=0x3;export function make(){const _0x2892b1=a20_0x1ad3;let _0x407dd0={'fSensZoomP':0x1,'fSensZoomO':0x2,'fSensPanP':0x1,'fSensPanO':0x1,'fSensMoveZ':0x1,'fSensRoll':0x1,'fSensRot':0x3,'eLockAxis':a20_0x5b02b2[_0x2892b1(0xe3)],'bDragging':![],'eControl':eZoom,'vDragPoint':a20_0x16af57[_0x2892b1(0xec)](0x0,0x0),'bInvertRot':![],'boudnsScene':a20_0x5dc102[_0x2892b1(0x10d)](),'camera':null};return _0x407dd0;}export function setControl(_0x21201e,_0x5a3aae){const _0x4b34dc=a20_0x1ad3;(_0x5a3aae<eZoom||_0x5a3aae>eRotDir)&&(_0x21201e[_0x4b34dc(0xfc)]=eRotPos),_0x21201e[_0x4b34dc(0xfc)]=_0x5a3aae;}export function beginDrag(_0x54b71a,_0x39702b,_0x506309,_0x504031){const _0x20bfdc=a20_0x1ad3;_0x54b71a[_0x20bfdc(0xf4)]=!![],_0x54b71a[_0x20bfdc(0xea)]=_0x39702b,_0x54b71a[_0x20bfdc(0x110)]!=null?_0x54b71a[_0x20bfdc(0xee)]=a20_0x4eb301[_0x20bfdc(0xdd)](_0x39702b[_0x20bfdc(0x101)][_0x20bfdc(0xd8)],a20_0x4eb301[_0x20bfdc(0xf5)](_0x54b71a['eLockAxis']))<0x0:_0x54b71a['bInvertRot']=![],a20_0x16af57['assign'](_0x54b71a[_0x20bfdc(0x105)],_0x506309),_0x504031!=null&&a20_0x5dc102[_0x20bfdc(0xde)](_0x54b71a[_0x20bfdc(0xdf)],_0x504031);}export function endDrag(_0x4802db){const _0x2fa1b7=a20_0x1ad3;_0x4802db[_0x2fa1b7(0xf4)]=![],_0x4802db[_0x2fa1b7(0xea)]=null;}function a20_0x1ad3(_0x271bf8,_0xe2827d){_0x271bf8=_0x271bf8-0xd7;let _0x38d078=a20_0x38d0[_0x271bf8];return _0x38d078;}export function drag(_0x118891,_0x500938){const _0x293fa0=a20_0x1ad3;if(_0x118891[_0x293fa0(0xf4)]){let _0x421402=a20_0x16af57['sub'](null,_0x118891[_0x293fa0(0x105)],_0x500938);a20_0x16af57[_0x293fa0(0xde)](_0x118891[_0x293fa0(0x105)],_0x500938);if(_0x118891['eControl']==eZoom)zoom(_0x118891,_0x118891[_0x293fa0(0xea)],_0x421402);else{if(_0x118891[_0x293fa0(0xfc)]==ePan)pan(_0x118891,_0x118891[_0x293fa0(0xea)],_0x421402);else{if(_0x118891[_0x293fa0(0xfc)]==eRotPos)rotPos(_0x118891,_0x118891[_0x293fa0(0xea)],_0x421402);else _0x118891[_0x293fa0(0xfc)]==eRotDir&&rotDir(_0x118891,_0x118891[_0x293fa0(0xea)],_0x421402);}}}}export function zoomWithMouseWheel(_0x5cb6dd,_0x3dd729,_0x133d8a,_0x3438e8=0.05){const _0x205e08=a20_0x1ad3;zoom(_0x5cb6dd,_0x3dd729,a20_0x16af57[_0x205e08(0xec)](0x0,a20_0x5b02b2[_0x205e08(0xfe)](_0x133d8a)*_0x3dd729[_0x205e08(0xe6)][_0x205e08(0xd7)]*_0x3438e8));}export function zoomWithTouch(_0x52b73a,_0x2bb3b8,_0x17482c,_0x34dc62=0.05){const _0xb97b77=a20_0x1ad3;zoom(_0x52b73a,_0x2bb3b8,a20_0x16af57[_0xb97b77(0xec)](0x0,a20_0x5b02b2[_0xb97b77(0xfe)](_0x17482c)*_0x2bb3b8[_0xb97b77(0xe6)][_0xb97b77(0xd7)]*_0x34dc62));}export function zoom(_0x5fe3e4,_0x34d114,_0x143ebd){const _0x3d2442=a20_0x1ad3;let _0x141e34=a20_0x532720[_0x3d2442(0xdc)](null,_0x34d114,_0x143ebd);if(_0x34d114['desc'][_0x3d2442(0x10f)]==a20_0x532720['ePerspective']){const _0x597314=_0x34d114['desc'][_0x3d2442(0x107)],_0x2c834c=_0x34d114[_0x3d2442(0x101)][_0x3d2442(0x10b)];let _0x53c268=a20_0x4eb301[_0x3d2442(0x10e)](_0x597314,_0x2c834c),_0x194ee1=(_0x141e34[0x0]+_0x141e34[0x1])*_0x5fe3e4['fSensZoomP']*_0x53c268,_0x44157f=_0x53c268+_0x194ee1,_0x2c82ef=_0x34d114[_0x3d2442(0x101)][_0x3d2442(0xe8)]*(0x1+0.001);if(_0x44157f<_0x2c82ef){let _0x54dca1=a20_0x532720[_0x3d2442(0xed)](null,_0x34d114,a20_0x5b02b2[_0x3d2442(0xeb)]),_0x1c9057;{_0x1c9057=a20_0x4eb301[_0x3d2442(0x106)](null,_0x54dca1,_0x2c82ef),_0x1c9057=a20_0x4eb301[_0x3d2442(0x104)](_0x1c9057,_0x1c9057,_0x2c834c);}a20_0x532720['setViewParam'](_0x34d114,_0x1c9057,null,null);}else{let _0x3a9542=a20_0x532720['viewAxisInWorld'](null,_0x34d114,a20_0x5b02b2[_0x3d2442(0xeb)]),_0x3463e4;{_0x3463e4=a20_0x4eb301[_0x3d2442(0x106)](null,_0x3a9542,_0x194ee1),_0x3463e4=a20_0x4eb301['add'](_0x3463e4,_0x3463e4,_0x597314);}a20_0x532720[_0x3d2442(0xe5)](_0x34d114,_0x3463e4,null,null);}}else{let _0x5fe45c;{_0x5fe45c=a20_0x4eb301[_0x3d2442(0xec)]((_0x141e34[0x0]+_0x141e34[0x1])*_0x5fe3e4[_0x3d2442(0xda)],0x0,0x0),_0x5fe45c=a20_0x3e4ce6[_0x3d2442(0xe7)](_0x5fe45c,_0x5fe45c,_0x34d114[_0x3d2442(0xf8)]);}let _0x5b63bd=a20_0x5b02b2['max'](_0x34d114[_0x3d2442(0x101)][_0x3d2442(0xf9)]+_0x5fe45c[0x0],0.001);a20_0x532720[_0x3d2442(0x102)](_0x34d114,_0x5b63bd,null,null,null);}}export function pan(_0x38bfa7,_0x1cf5d6,_0x167d69){const _0x5400c1=a20_0x1ad3;if(_0x1cf5d6[_0x5400c1(0x101)][_0x5400c1(0x10f)]==a20_0x532720[_0x5400c1(0xfb)]){let _0x57636e;{_0x57636e=a20_0x3e4ce6[_0x5400c1(0xe1)](null,_0x1cf5d6[_0x5400c1(0x101)][_0x5400c1(0x10b)],_0x1cf5d6['mView'])[0x2],_0x57636e*=-Math['tan'](0.5*_0x1cf5d6['desc'][_0x5400c1(0xf0)]);}let _0x187b38;{_0x187b38=a20_0x532720['screenToClipV'](null,_0x1cf5d6,_0x167d69),_0x187b38=a20_0x16af57[_0x5400c1(0x106)](_0x187b38,_0x187b38,_0x57636e*_0x38bfa7[_0x5400c1(0xf3)]);}let _0x4d0369;{_0x4d0369=a20_0x532720[_0x5400c1(0xed)](null,_0x1cf5d6,a20_0x5b02b2['eAxisX']),_0x4d0369=a20_0x4eb301[_0x5400c1(0x106)](_0x4d0369,_0x4d0369,_0x187b38[0x0]*_0x1cf5d6[_0x5400c1(0x101)][_0x5400c1(0xf1)]);}let _0x288b58;{_0x288b58=a20_0x532720[_0x5400c1(0xed)](null,_0x1cf5d6,a20_0x5b02b2[_0x5400c1(0xe3)]),_0x288b58=a20_0x4eb301[_0x5400c1(0x106)](_0x288b58,_0x288b58,_0x187b38[0x1]);}let _0x27113c=a20_0x4eb301[_0x5400c1(0x104)](null,_0x4d0369,_0x288b58),_0x4287fb=a20_0x4eb301['add'](null,_0x1cf5d6[_0x5400c1(0x101)][_0x5400c1(0x107)],_0x27113c),_0x1f52a4=a20_0x4eb301[_0x5400c1(0x104)](null,_0x1cf5d6[_0x5400c1(0x101)]['vAt'],_0x27113c);a20_0x532720[_0x5400c1(0xe5)](_0x1cf5d6,_0x4287fb,_0x1f52a4,null);}else{let _0x4ba4e5=-_0x1cf5d6[_0x5400c1(0x101)][_0x5400c1(0xf9)]/_0x1cf5d6[_0x5400c1(0xe6)][_0x5400c1(0xf9)],_0x20d95=-_0x4ba4e5,_0x380345=_0x167d69[0x0]*_0x4ba4e5*_0x38bfa7['fSensPanO'],_0x2e3806=_0x167d69[0x1]*_0x20d95*_0x38bfa7[_0x5400c1(0xf7)],_0x59e64d;{_0x59e64d=a20_0x532720['viewAxisInWorld'](null,_0x1cf5d6,a20_0x5b02b2['eAxisX']),_0x59e64d=a20_0x4eb301[_0x5400c1(0x106)](_0x59e64d,_0x59e64d,_0x380345);}let _0x33bedf;{_0x33bedf=a20_0x532720['viewAxisInWorld'](null,_0x1cf5d6,a20_0x5b02b2['eAxisY']),_0x33bedf=a20_0x4eb301['mul'](_0x33bedf,_0x33bedf,_0x2e3806);}let _0x2fd67b=a20_0x4eb301['add'](null,_0x59e64d,_0x33bedf),_0x32c76e=a20_0x4eb301[_0x5400c1(0x104)](null,_0x1cf5d6[_0x5400c1(0x101)]['vEye'],_0x2fd67b),_0x1bc395=a20_0x4eb301['add'](null,_0x1cf5d6[_0x5400c1(0x101)]['vAt'],_0x2fd67b);a20_0x532720[_0x5400c1(0xe5)](_0x1cf5d6,_0x32c76e,_0x1bc395,null);}}export function rotPos(_0x26fbc4,_0x41856a,_0x1a8399){const _0x444355=a20_0x1ad3;let _0x295026;{_0x295026=a20_0x16af57[_0x444355(0x106)](_0x295026,_0x1a8399,a20_0x16af57[_0x444355(0xec)](0x1,-0x1)),_0x295026=a20_0x532720[_0x444355(0xdc)](_0x295026,_0x41856a,_0x295026),_0x26fbc4[_0x444355(0xee)]&&(_0x295026[0x0]=-_0x295026[0x0]);}let _0x462446;{if(_0x26fbc4[_0x444355(0x110)]==a20_0x5b02b2[_0x444355(0x108)])_0x462446=a20_0x3e4ce6['rotateX'](null,_0x295026[0x1]*_0x26fbc4[_0x444355(0x10a)]);else{if(_0x26fbc4['eLockAxis']==a20_0x5b02b2[_0x444355(0xe3)])_0x462446=a20_0x3e4ce6[_0x444355(0x100)](null,_0x295026[0x0]*_0x26fbc4[_0x444355(0x10a)]);else{if(_0x26fbc4[_0x444355(0x110)]==a20_0x5b02b2[_0x444355(0xeb)])_0x462446=a20_0x3e4ce6[_0x444355(0xe2)](null,_0x295026[0x0]*_0x26fbc4[_0x444355(0x10a)]);else{let _0x318252=a20_0x532720[_0x444355(0xed)](null,_0x41856a,a20_0x5b02b2[_0x444355(0xe3)]);_0x462446=a20_0x3e4ce6[_0x444355(0xe9)](null,_0x318252,_0x295026[0x0]*_0x26fbc4[_0x444355(0x10a)]);}}}}let _0x781e3a;{let _0xf36552=a20_0x532720['viewAxisInWorld'](null,_0x41856a,a20_0x5b02b2[_0x444355(0x108)]);_0x781e3a=a20_0x3e4ce6[_0x444355(0xe9)](null,_0xf36552,_0x295026[0x1]*_0x26fbc4['fSensRot']);}let _0x521efd;{_0x521efd=a20_0x3e4ce6[_0x444355(0x10c)](null,a20_0x4eb301[_0x444355(0xdb)](null,_0x41856a[_0x444355(0x101)][_0x444355(0x10b)])),_0x521efd=a20_0x3e4ce6[_0x444355(0x106)](_0x521efd,_0x521efd,_0x781e3a),_0x521efd=a20_0x3e4ce6[_0x444355(0x106)](_0x521efd,_0x521efd,_0x462446),_0x521efd=a20_0x3e4ce6[_0x444355(0x106)](_0x521efd,_0x521efd,a20_0x3e4ce6[_0x444355(0x10c)](null,_0x41856a[_0x444355(0x101)][_0x444355(0x10b)]));}let _0x206bda=a20_0x3e4ce6[_0x444355(0xe1)](null,_0x41856a[_0x444355(0x101)]['vEye'],_0x521efd),_0x3eccd2;{let _0x5c930f=a20_0x3e4ce6[_0x444355(0x106)](null,_0x781e3a,_0x462446);_0x3eccd2=a20_0x532720[_0x444355(0xed)](null,_0x41856a,a20_0x5b02b2[_0x444355(0xe3)]),_0x3eccd2=a20_0x3e4ce6['transformVec3'](_0x3eccd2,_0x3eccd2,_0x5c930f);}a20_0x532720['setViewParam'](_0x41856a,_0x206bda,null,_0x3eccd2);}export function rotDir(_0x395ddb,_0x40ce1f,_0x1a6136){const _0x31c2b6=a20_0x1ad3;let _0x15115e;{_0x15115e=a20_0x16af57[_0x31c2b6(0x106)](_0x15115e,_0x1a6136,a20_0x16af57['from'](-0x1,0x1)),_0x15115e=a20_0x532720['screenToClipV'](_0x15115e,_0x40ce1f,_0x15115e),_0x15115e=a20_0x16af57[_0x31c2b6(0xdb)](_0x15115e,_0x15115e),_0x395ddb[_0x31c2b6(0xee)]&&(_0x15115e[0x0]=-_0x15115e[0x0]);}let _0x1d22b7;{if(_0x395ddb[_0x31c2b6(0x110)]==a20_0x5b02b2[_0x31c2b6(0x108)])_0x1d22b7=a20_0x3e4ce6[_0x31c2b6(0xf6)](null,_0x15115e[0x0]*_0x395ddb[_0x31c2b6(0x10a)]);else _0x395ddb[_0x31c2b6(0x110)]==a20_0x5b02b2[_0x31c2b6(0xe3)]?_0x1d22b7=a20_0x3e4ce6[_0x31c2b6(0x100)](null,_0x15115e[0x0]*_0x395ddb['fSensRot']):_0x1d22b7=a20_0x3e4ce6[_0x31c2b6(0xe2)](null,_0x15115e[0x0]*_0x395ddb[_0x31c2b6(0x10a)]);}let _0x1646c4;{let _0x4b3270=a20_0x532720['viewAxisInWorld'](null,_0x40ce1f,a20_0x5b02b2['eAxisX']);_0x1646c4=a20_0x3e4ce6['rotate'](null,_0x4b3270,_0x15115e[0x1]*_0x395ddb[_0x31c2b6(0x10a)]);}let _0x287c4d;{_0x287c4d=a20_0x3e4ce6['translation'](null,a20_0x4eb301[_0x31c2b6(0xdb)](null,_0x40ce1f[_0x31c2b6(0x101)][_0x31c2b6(0x107)])),_0x287c4d=a20_0x3e4ce6[_0x31c2b6(0x106)](_0x287c4d,_0x287c4d,_0x1646c4),_0x287c4d=a20_0x3e4ce6[_0x31c2b6(0x106)](_0x287c4d,_0x287c4d,_0x1d22b7),_0x287c4d=a20_0x3e4ce6[_0x31c2b6(0x106)](_0x287c4d,_0x287c4d,a20_0x3e4ce6['translation'](null,_0x40ce1f[_0x31c2b6(0x101)][_0x31c2b6(0x107)]));}let _0x13d1c4=a20_0x3e4ce6[_0x31c2b6(0xe1)](null,_0x40ce1f['desc']['vAt'],_0x287c4d),_0xbab941;{let _0x3df006=a20_0x3e4ce6[_0x31c2b6(0x106)](null,_0x1646c4,_0x1d22b7);_0xbab941=a20_0x532720[_0x31c2b6(0xed)](null,_0x40ce1f,a20_0x5b02b2['eAxisY']),_0xbab941=a20_0x3e4ce6[_0x31c2b6(0xe7)](_0xbab941,_0xbab941,_0x3df006);}a20_0x532720[_0x31c2b6(0xe5)](_0x40ce1f,null,_0x13d1c4,_0xbab941);}export function lockUpAxis(_0x430664,_0xdaeb4c){const _0x4143d=a20_0x1ad3;_0xdaeb4c!=a20_0x5b02b2[_0x4143d(0x108)]&&_0xdaeb4c!=a20_0x5b02b2[_0x4143d(0xe3)]&&_0xdaeb4c!=a20_0x5b02b2[_0x4143d(0xeb)]?_0x430664[_0x4143d(0x110)]=null:_0x430664[_0x4143d(0x110)]=_0xdaeb4c;}export function rotate(_0x3c886d,_0x37ebd2,_0x322c2c,_0x273033){const _0x2a1fdd=a20_0x1ad3;_0x3c886d[_0x2a1fdd(0xea)]=_0x37ebd2;if(_0x322c2c==eZoom)zoom(_0x3c886d,_0x3c886d[_0x2a1fdd(0xea)],_0x273033);else{if(_0x322c2c==ePan)pan(_0x3c886d,_0x3c886d[_0x2a1fdd(0xea)],_0x273033);else{if(_0x322c2c==eRotPos)rotPos(_0x3c886d,_0x3c886d[_0x2a1fdd(0xea)],_0x273033);else _0x322c2c==eRotDir&&rotDir(_0x3c886d,_0x3c886d[_0x2a1fdd(0xea)],_0x273033);}}}