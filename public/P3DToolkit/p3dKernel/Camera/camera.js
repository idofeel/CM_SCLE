'use strict';const a18_0x269f=['mViewI','projOrtho','transformPoint3','mView','inverse','extent','1651319RVSPrE','fNear','safeReciprocal','1090998vsgejo','mViewIT','fFOVInRadian','vEye','viewport','1yLOEde','lookAt','set','2396447iovQEP','mViewProj','projPerspective','transpose','transformPoint3PerspectiveDivide','from','copy','fAspect','fTopLeftX','vAt','fHeight','mul','vUp','eProjType','mProjI','fFar','fWidth','desc','add','max','make','901984JLfgXx','mProj','1733477fcGKoO','838324YDvitx','fTopLeftY','toRadian','tan','mProjIT','halfExtent','mViewProjI','1fuZkht','438350euXJYh','assign','center'];(function(_0x33da7a,_0x40ebcb){const _0x230e46=a18_0x5919;while(!![]){try{const _0x5a3914=parseInt(_0x230e46(0x164))+parseInt(_0x230e46(0x17e))*-parseInt(_0x230e46(0x179))+-parseInt(_0x230e46(0x162))+-parseInt(_0x230e46(0x16c))*parseInt(_0x230e46(0x176))+-parseInt(_0x230e46(0x16d))+parseInt(_0x230e46(0x165))+parseInt(_0x230e46(0x14d));if(_0x5a3914===_0x40ebcb)break;else _0x33da7a['push'](_0x33da7a['shift']());}catch(_0x1ad498){_0x33da7a['push'](_0x33da7a['shift']());}}}(a18_0x269f,0xd835d));import*as a18_0x54f5bb from'../Math/math.js';import*as a18_0x1d2227 from'../Math/float2.js';import*as a18_0x3481a3 from'../Math/float3.js';import*as a18_0xf3606b from'../Math/matrix.js';import*as a18_0x4261d0 from'../Math/box.js';export const ePerspective=0x0;export const eOrthographic=0x1;export function makeDesc(){const _0x2bc9b0=a18_0x5919;let _0x3f29a9={'eProjType':ePerspective,'vEye':a18_0x3481a3['from'](0x0,0x0,0x5),'vAt':a18_0x3481a3['from'](0x0,0x0,0x0),'vUp':a18_0x3481a3[_0x2bc9b0(0x152)](0x0,0x1,0x0),'fFOVInRadian':a18_0x54f5bb[_0x2bc9b0(0x167)](0x3c),'fWidth':0x64,'fAspect':0x1,'fNear':0.01,'fFar':0x3e8};return _0x3f29a9;}export function copyDesc(_0x4fc759){const _0xe791f3=a18_0x5919;let _0x144c08={'eProjType':_0x4fc759[_0xe791f3(0x15a)],'vEye':a18_0x3481a3[_0xe791f3(0x153)](_0x4fc759['vEye']),'vAt':a18_0x3481a3[_0xe791f3(0x153)](_0x4fc759['vAt']),'vUp':a18_0x3481a3['copy'](_0x4fc759[_0xe791f3(0x159)]),'fFOVInRadian':_0x4fc759[_0xe791f3(0x17b)],'fWidth':_0x4fc759[_0xe791f3(0x15d)],'fAspect':_0x4fc759[_0xe791f3(0x154)],'fNear':_0x4fc759[_0xe791f3(0x177)],'fFar':_0x4fc759[_0xe791f3(0x15c)]};return _0x144c08;}export function assignDesc(_0x4e134d,_0x3745d0){const _0x30a4ee=a18_0x5919;_0x4e134d[_0x30a4ee(0x15a)]=_0x3745d0['eProjType'],_0x4e134d[_0x30a4ee(0x17b)]=_0x3745d0[_0x30a4ee(0x17b)],_0x4e134d[_0x30a4ee(0x15d)]=_0x3745d0[_0x30a4ee(0x15d)],(_0x4e134d['fAspect']=_0x3745d0[_0x30a4ee(0x154)],_0x4e134d['fNear']=_0x3745d0[_0x30a4ee(0x177)]),_0x4e134d[_0x30a4ee(0x15c)]=_0x3745d0['fFar'],a18_0x3481a3[_0x30a4ee(0x16e)](_0x4e134d[_0x30a4ee(0x17c)],_0x3745d0['vEye']),a18_0x3481a3[_0x30a4ee(0x16e)](_0x4e134d[_0x30a4ee(0x156)],_0x3745d0['vAt']),a18_0x3481a3[_0x30a4ee(0x16e)](_0x4e134d[_0x30a4ee(0x159)],_0x3745d0[_0x30a4ee(0x159)]);}export function makeViewport(){let _0x1e131d={'fTopLeftX':0x0,'fTopLeftY':0x0,'fWidth':0x64,'fHeight':0x64};return _0x1e131d;}export function copyViewport(_0x4720eb){const _0x15ddde=a18_0x5919;let _0x31e75d={'fTopLeftX':_0x4720eb[_0x15ddde(0x155)],'fTopLeftY':_0x4720eb[_0x15ddde(0x166)],'fWidth':_0x4720eb[_0x15ddde(0x15d)],'fHeight':_0x4720eb[_0x15ddde(0x157)]};return _0x31e75d;}export function viewportAspect(_0x3c2189){const _0x5686ef=a18_0x5919;return _0x3c2189[_0x5686ef(0x15d)]/_0x3c2189['fHeight'];}export function make(){const _0x15f861=a18_0x5919;let _0x1cdaca={'desc':makeDesc(),'mView':a18_0xf3606b[_0x15f861(0x161)](),'mViewI':a18_0xf3606b[_0x15f861(0x161)](),'mViewIT':a18_0xf3606b[_0x15f861(0x161)](),'mProj':a18_0xf3606b[_0x15f861(0x161)](),'mProjI':a18_0xf3606b['make'](),'mProjIT':a18_0xf3606b[_0x15f861(0x161)](),'mViewProj':a18_0xf3606b[_0x15f861(0x161)](),'mViewProjI':a18_0xf3606b['make'](),'viewport':makeViewport()};return rebuildViewMatrix(_0x1cdaca),rebuildProjMatrix(_0x1cdaca),_0x1cdaca;}export function viewAxisInWorld(_0x39170c,_0x2e2fba,_0x1f4f9f){return a18_0xf3606b['transformUnitAxis'](_0x39170c,_0x1f4f9f,_0x2e2fba['mViewI']);}export function screenToClip(_0x4d4026,_0x1096b5,_0x45d776){const _0x2506c7=a18_0x5919;return _0x4d4026=_0x4d4026||a18_0x1d2227[_0x2506c7(0x161)](),_0x4d4026[0x0]=(0x2*(_0x45d776[0x0]-_0x1096b5[_0x2506c7(0x17d)][_0x2506c7(0x155)])-_0x1096b5[_0x2506c7(0x17d)]['fWidth'])*a18_0x54f5bb[_0x2506c7(0x178)](_0x1096b5['viewport'][_0x2506c7(0x15d)]),_0x4d4026[0x1]=-(0x2*(_0x45d776[0x1]-_0x1096b5[_0x2506c7(0x17d)][_0x2506c7(0x166)])-_0x1096b5['viewport'][_0x2506c7(0x157)])*a18_0x54f5bb[_0x2506c7(0x178)](_0x1096b5[_0x2506c7(0x17d)][_0x2506c7(0x157)]),_0x4d4026;}export function screenToClipV(_0x371641,_0x31beba,_0x356d3a){const _0x1b9516=a18_0x5919;return _0x371641=_0x371641||a18_0x1d2227[_0x1b9516(0x161)](),_0x371641[0x0]=0x2*_0x356d3a[0x0]*a18_0x54f5bb[_0x1b9516(0x178)](_0x31beba[_0x1b9516(0x17d)][_0x1b9516(0x15d)]),_0x371641[0x1]=-(0x2*_0x356d3a[0x1])*a18_0x54f5bb['safeReciprocal'](_0x31beba[_0x1b9516(0x17d)][_0x1b9516(0x157)]),_0x371641;}export function clipToScreen(_0x5b309b,_0x34e848,_0x1dfca7){const _0x5353af=a18_0x5919;return _0x5b309b=_0x5b309b||a18_0x1d2227[_0x5353af(0x161)](),_0x5b309b[0x0]=_0x34e848['viewport'][_0x5353af(0x155)]+(_0x1dfca7[0x0]*0.5+0.5)*_0x34e848['viewport'][_0x5353af(0x15d)],_0x5b309b[0x1]=_0x34e848[_0x5353af(0x17d)][_0x5353af(0x166)]-(_0x1dfca7[0x1]*0.5-0.5)*_0x34e848[_0x5353af(0x17d)][_0x5353af(0x157)],_0x5b309b;}export function clipToScreenV(_0x38ade3,_0x26a5c9,_0x2f863e){const _0x181072=a18_0x5919;return _0x38ade3=_0x38ade3||a18_0x1d2227['make'](),_0x38ade3[0x0]=0.5*_0x2f863e[0x0]*_0x26a5c9[_0x181072(0x17d)][_0x181072(0x15d)],_0x38ade3[0x1]=-(0.5*_0x2f863e[0x1])*_0x26a5c9[_0x181072(0x17d)][_0x181072(0x157)],_0x38ade3;}export function screenToWorld(_0x4e83ea,_0x497514,_0x36cfdb){const _0x1c7594=a18_0x5919;return _0x4e83ea=_0x4e83ea||a18_0x3481a3[_0x1c7594(0x161)](),_0x4e83ea=screenToClip(_0x4e83ea,_0x497514,_0x36cfdb),_0x4e83ea[0x2]=_0x36cfdb[0x2],a18_0xf3606b[_0x1c7594(0x172)](_0x4e83ea,_0x4e83ea,_0x497514['mViewProjI']);}export function worldToScreen(_0x572ab3,_0x58fae9,_0x306c22){return _0x572ab3=a18_0xf3606b['transformPoint3'](_0x572ab3,_0x306c22,_0x58fae9['mViewProj']),_0x572ab3=clipToScreen(_0x572ab3,_0x58fae9,_0x572ab3),_0x572ab3;}export function setViewParam(_0x2b7043,_0x1c2ea4,_0x35f7bf,_0x50f109){const _0xe2fe71=a18_0x5919;if(_0x1c2ea4!=null)a18_0x3481a3[_0xe2fe71(0x16e)](_0x2b7043[_0xe2fe71(0x15e)][_0xe2fe71(0x17c)],_0x1c2ea4);if(_0x35f7bf!=null)a18_0x3481a3['assign'](_0x2b7043[_0xe2fe71(0x15e)][_0xe2fe71(0x156)],_0x35f7bf);if(_0x50f109!=null)a18_0x3481a3[_0xe2fe71(0x16e)](_0x2b7043[_0xe2fe71(0x15e)][_0xe2fe71(0x159)],_0x50f109);rebuildViewMatrix(_0x2b7043);}export function setViewMatrix(_0x2b17d2,_0x296ec0){const _0x165c7c=a18_0x5919;_0x2b17d2['desc'][_0x165c7c(0x17c)][0x0]=_0x296ec0[0xc],_0x2b17d2['desc'][_0x165c7c(0x17c)][0x1]=_0x296ec0[0xd],_0x2b17d2[_0x165c7c(0x15e)]['vEye'][0x2]=_0x296ec0[0xe],_0x2b17d2['desc'][_0x165c7c(0x156)][0x0]=_0x2b17d2[_0x165c7c(0x15e)][_0x165c7c(0x17c)][0x0]-_0x296ec0[0x8],_0x2b17d2[_0x165c7c(0x15e)][_0x165c7c(0x156)][0x1]=_0x2b17d2[_0x165c7c(0x15e)][_0x165c7c(0x17c)][0x1]-_0x296ec0[0x9],_0x2b17d2['desc']['vAt'][0x2]=_0x2b17d2['desc']['vEye'][0x2]-_0x296ec0[0xa],_0x2b17d2['desc'][_0x165c7c(0x159)][0x0]=_0x296ec0[0x4],_0x2b17d2[_0x165c7c(0x15e)][_0x165c7c(0x159)][0x1]=_0x296ec0[0x5],_0x2b17d2['desc'][_0x165c7c(0x159)][0x2]=_0x296ec0[0x6],rebuildViewMatrix(_0x2b17d2);}export function setPerspective(_0x550c7b,_0x502701,_0x4d3e37,_0x545fba,_0x18ff82){const _0x82fe3c=a18_0x5919;_0x550c7b['desc']['eProjType']=ePerspective;if(_0x502701!=null)_0x550c7b[_0x82fe3c(0x15e)][_0x82fe3c(0x17b)]=_0x502701;if(_0x4d3e37!=null)_0x550c7b[_0x82fe3c(0x15e)][_0x82fe3c(0x154)]=_0x4d3e37;if(_0x545fba!=null)_0x550c7b[_0x82fe3c(0x15e)][_0x82fe3c(0x177)]=_0x545fba;if(_0x18ff82!=null)_0x550c7b[_0x82fe3c(0x15e)][_0x82fe3c(0x15c)]=_0x18ff82;rebuildProjMatrix(_0x550c7b);}function a18_0x5919(_0x1ff782,_0x22f768){_0x1ff782=_0x1ff782-0x14b;let _0x269f68=a18_0x269f[_0x1ff782];return _0x269f68;}export function setOrthographic(_0x58b9b6,_0x36266e,_0x288a38,_0x27a983,_0x35e29a){const _0x1004a3=a18_0x5919;_0x58b9b6[_0x1004a3(0x15e)]['eProjType']=eOrthographic;if(_0x36266e!=null)_0x58b9b6[_0x1004a3(0x15e)][_0x1004a3(0x15d)]=_0x36266e;if(_0x288a38!=null)_0x58b9b6[_0x1004a3(0x15e)][_0x1004a3(0x154)]=_0x288a38;if(_0x27a983!=null)_0x58b9b6['desc'][_0x1004a3(0x177)]=_0x27a983;if(_0x35e29a!=null)_0x58b9b6[_0x1004a3(0x15e)][_0x1004a3(0x15c)]=_0x35e29a;rebuildProjMatrix(_0x58b9b6);}export function setViewport(_0x3e752f,_0x84059,_0x2e1f2,_0x275eef,_0x56d541){const _0x2828a6=a18_0x5919;_0x3e752f[_0x2828a6(0x17d)]['fWidth']=_0x84059,_0x3e752f[_0x2828a6(0x17d)]['fHeight']=_0x2e1f2;if(_0x275eef!=null)_0x3e752f[_0x2828a6(0x17d)][_0x2828a6(0x155)]=_0x275eef;if(_0x56d541!=null)_0x3e752f[_0x2828a6(0x17d)][_0x2828a6(0x166)]=_0x56d541;_0x3e752f['desc'][_0x2828a6(0x154)]=viewportAspect(_0x3e752f[_0x2828a6(0x17d)]);if(_0x3e752f[_0x2828a6(0x15e)]['eProjType']==ePerspective){let _0x7be0cc=getProjectiveScaleX(_0x3e752f,_0x3e752f[_0x2828a6(0x15e)][_0x2828a6(0x156)]);_0x3e752f[_0x2828a6(0x15e)]['fWidth']=_0x7be0cc*0x2;}rebuildProjMatrix(_0x3e752f);}export function updateDesc(_0x2b8b5c,_0x29cd22){_0x2b8b5c['desc']=copyDesc(_0x29cd22),rebuildViewMatrix(_0x2b8b5c),rebuildProjMatrix(_0x2b8b5c);}function rebuildViewMatrix(_0x264816){const _0x2b3ceb=a18_0x5919;_0x264816[_0x2b3ceb(0x173)]=a18_0xf3606b[_0x2b3ceb(0x14b)](_0x264816[_0x2b3ceb(0x173)],_0x264816[_0x2b3ceb(0x15e)][_0x2b3ceb(0x17c)],_0x264816[_0x2b3ceb(0x15e)][_0x2b3ceb(0x156)],_0x264816[_0x2b3ceb(0x15e)][_0x2b3ceb(0x159)]),_0x264816[_0x2b3ceb(0x170)]=a18_0xf3606b['inverse'](_0x264816[_0x2b3ceb(0x170)],_0x264816[_0x2b3ceb(0x173)]),_0x264816[_0x2b3ceb(0x17a)]=a18_0xf3606b[_0x2b3ceb(0x150)](_0x264816[_0x2b3ceb(0x17a)],_0x264816[_0x2b3ceb(0x170)]),_0x264816[_0x2b3ceb(0x14e)]=a18_0xf3606b[_0x2b3ceb(0x158)](_0x264816[_0x2b3ceb(0x14e)],_0x264816['mView'],_0x264816['mProj']),_0x264816[_0x2b3ceb(0x16b)]=a18_0xf3606b['mul'](_0x264816[_0x2b3ceb(0x16b)],_0x264816[_0x2b3ceb(0x15b)],_0x264816[_0x2b3ceb(0x170)]);}function rebuildProjMatrix(_0x4bb208){const _0x1246fb=a18_0x5919;_0x4bb208['desc'][_0x1246fb(0x15a)]==ePerspective?_0x4bb208[_0x1246fb(0x163)]=a18_0xf3606b[_0x1246fb(0x14f)](_0x4bb208['mProj'],_0x4bb208[_0x1246fb(0x15e)][_0x1246fb(0x17b)],_0x4bb208['desc'][_0x1246fb(0x154)],_0x4bb208[_0x1246fb(0x15e)][_0x1246fb(0x177)],_0x4bb208['desc'][_0x1246fb(0x15c)]):_0x4bb208[_0x1246fb(0x163)]=a18_0xf3606b[_0x1246fb(0x171)](_0x4bb208[_0x1246fb(0x163)],_0x4bb208['desc'][_0x1246fb(0x15d)],_0x4bb208[_0x1246fb(0x15e)][_0x1246fb(0x15d)]/_0x4bb208['desc']['fAspect'],_0x4bb208[_0x1246fb(0x15e)][_0x1246fb(0x177)],_0x4bb208[_0x1246fb(0x15e)][_0x1246fb(0x15c)]),_0x4bb208[_0x1246fb(0x15b)]=a18_0xf3606b[_0x1246fb(0x174)](_0x4bb208[_0x1246fb(0x15b)],_0x4bb208['mProj']),_0x4bb208[_0x1246fb(0x169)]=a18_0xf3606b['transpose'](_0x4bb208['mProjIT'],_0x4bb208[_0x1246fb(0x15b)]),_0x4bb208[_0x1246fb(0x14e)]=a18_0xf3606b['mul'](_0x4bb208[_0x1246fb(0x14e)],_0x4bb208[_0x1246fb(0x173)],_0x4bb208[_0x1246fb(0x163)]),_0x4bb208[_0x1246fb(0x16b)]=a18_0xf3606b[_0x1246fb(0x158)](_0x4bb208['mViewProjI'],_0x4bb208[_0x1246fb(0x15b)],_0x4bb208[_0x1246fb(0x170)]);}export function computeSafeMinDistance(_0x318f5b){const _0x51c52b=a18_0x5919;return _0x318f5b['desc'][_0x51c52b(0x177)]*(0x1+0.001);}export function computeFocusOnBoxDesc(_0x195d4c,_0xb3b324){const _0x422503=a18_0x5919;let _0x4837ca=make();{updateDesc(_0x4837ca,_0x195d4c[_0x422503(0x15e)]);}if(_0x4837ca[_0x422503(0x15e)]['eProjType']==ePerspective){let _0x101e28=a18_0x4261d0['center'](null,_0xb3b324);if(a18_0x3481a3['distanceSq'](_0x101e28,_0x4837ca[_0x422503(0x15e)]['vEye'])<1e-10)return _0x4837ca['desc'];let _0x1217f2=a18_0x4261d0[_0x422503(0x16a)](null,a18_0x4261d0['transform'](null,_0xb3b324,_0x4837ca[_0x422503(0x173)])),_0xdd0a3b=_0x1217f2[0x1]/Math['tan'](_0x4837ca['desc']['fFOVInRadian']*0.5),_0x7ee1d1=_0x1217f2[0x0]/Math[_0x422503(0x168)](_0x4837ca[_0x422503(0x15e)]['fFOVInRadian']*0.5*_0x4837ca[_0x422503(0x15e)][_0x422503(0x154)]),_0x13603a;{_0x13603a=a18_0x54f5bb[_0x422503(0x160)](_0x7ee1d1,_0xdd0a3b)+_0x1217f2[0x2],_0x13603a=a18_0x54f5bb['max'](computeSafeMinDistance(_0x4837ca),_0x13603a);}let _0x5b1c69;{_0x5b1c69=viewAxisInWorld(null,_0x4837ca,a18_0x54f5bb['eAxisZ']),_0x5b1c69=a18_0x3481a3[_0x422503(0x158)](_0x5b1c69,_0x5b1c69,_0x13603a),_0x5b1c69=a18_0x3481a3[_0x422503(0x15f)](_0x5b1c69,_0x5b1c69,_0x101e28);}setViewParam(_0x4837ca,_0x5b1c69,_0x101e28,null);}else{let _0x59ff8f=a18_0x4261d0[_0x422503(0x16f)](null,_0xb3b324),_0x15d726;{_0x15d726=viewAxisInWorld(null,_0x4837ca,a18_0x54f5bb['eAxisZ']),_0x15d726=a18_0x3481a3['mul'](_0x15d726,_0x15d726,computeSafeMinDistance(_0x4837ca)),_0x15d726=a18_0x3481a3[_0x422503(0x15f)](_0x15d726,_0x15d726,_0x59ff8f);}setViewParam(_0x4837ca,_0x15d726,_0x59ff8f,null);let _0x5181e1=a18_0x4261d0[_0x422503(0x175)](null,a18_0x4261d0['transform'](null,_0xb3b324,_0x4837ca[_0x422503(0x173)])),_0xe5875f=a18_0x54f5bb[_0x422503(0x160)](_0x5181e1[0x0],_0x5181e1[0x1]*_0x4837ca[_0x422503(0x15e)]['fAspect']);setOrthographic(_0x4837ca,_0xe5875f,null,null,null);}return _0x4837ca[_0x422503(0x15e)];}export function computeDistance(_0x48c7d5){const _0x1e5489=a18_0x5919;return a18_0x3481a3['distance'](_0x48c7d5[_0x1e5489(0x15e)][_0x1e5489(0x17c)],_0x48c7d5[_0x1e5489(0x15e)][_0x1e5489(0x156)]);}export function setProjectiveType(_0x4b896e,_0x51754e){const _0x5eca3a=a18_0x5919;if(_0x4b896e[_0x5eca3a(0x15e)][_0x5eca3a(0x15a)]==ePerspective&&_0x51754e==eOrthographic){let _0x4c688e=getProjectiveScaleX(_0x4b896e,_0x4b896e[_0x5eca3a(0x15e)][_0x5eca3a(0x156)]);_0x4b896e[_0x5eca3a(0x15e)][_0x5eca3a(0x15d)]=_0x4c688e*0x2,_0x4b896e['desc'][_0x5eca3a(0x15a)]=eOrthographic;}else _0x4b896e[_0x5eca3a(0x15e)][_0x5eca3a(0x15a)]==eOrthographic&&_0x51754e==ePerspective&&(_0x4b896e[_0x5eca3a(0x15e)]['eProjType']=ePerspective);rebuildProjMatrix(_0x4b896e);}export function getProjectiveScaleX(_0x4110fe,_0x328c54){const _0x1e278e=a18_0x5919;let _0x4d145f=a18_0x3481a3[_0x1e278e(0x161)](),_0x2bf999=a18_0x3481a3[_0x1e278e(0x161)]();return a18_0xf3606b['transformPoint3PerspectiveDivide'](_0x2bf999,_0x328c54,_0x4110fe[_0x1e278e(0x173)]),a18_0x3481a3[_0x1e278e(0x14c)](_0x4d145f,0x1,0x0,_0x2bf999[0x2]),a18_0xf3606b[_0x1e278e(0x151)](_0x2bf999,_0x4d145f,_0x4110fe[_0x1e278e(0x163)]),0x1/_0x2bf999[0x0];}export function getProjectiveScaleY(_0x1e2e2e,_0x3e63aa){const _0x5ab3b1=a18_0x5919;let _0x4d7b94=a18_0x3481a3[_0x5ab3b1(0x161)](),_0x4b59e2=a18_0x3481a3[_0x5ab3b1(0x161)]();return a18_0xf3606b[_0x5ab3b1(0x151)](_0x4b59e2,_0x3e63aa,_0x1e2e2e['mView']),a18_0x3481a3[_0x5ab3b1(0x14c)](_0x4d7b94,0x0,0x1,_0x4b59e2[0x2]),a18_0xf3606b['transformPoint3PerspectiveDivide'](_0x4b59e2,_0x4d7b94,_0x1e2e2e[_0x5ab3b1(0x163)]),0x1/_0x4b59e2[0x1];}