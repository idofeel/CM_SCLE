'use strict';const a89_0x2f2f=['stuCameraSaveDataMgr','_arrObjAnimSaveData','failed\x20to\x20open\x20local\x20file:\x20','length','eUpAxis','uBoundsRevision','_arrMtlSaveData','strFileName','fAspect','generateMipmap','bounds','render','10uwgrsO','context','15671EUWRtg','localFileName','TEXTURE_2D','599138WmBthV','fromCleCamera','_imageWidth','getUpAxis','CLAMP_TO_EDGE','TEXTURE_2D_ARRAY','_stuSceneUnit','makeAxis','viewport','TEXTURE_WRAP_R','setViewParam','updateBounds','_DefaultCamera','make','_ModelInfo','_strModelName','vMaterialArray','292789ZkHhya','cmonline','bindTexture','fileName','_nCleBufferlength','_fFOVY','fromCleVec3','cleTexturePos','109607jQMlcE','vTextureMap','_nLengthUnit','stuMtlSaveDataMgr','readAsArrayBuffer','desc','create','LINEAR','max','_arrObjSaveData','checkIfDefaultCameraValid','uPos','stuObjSaveDataMgr','UNPACK_ALIGNMENT','onload','_imageHeight','arrResFile','_vFocus','current','pixelStorei','vMeshArray','_imageData','meet\x20a\x20unsupport\x20model\x20','byteLength','SRGB8','_vEyePos','_arrCameraAnimSaveData','RGBA8','TEXTURE_MIN_FILTER','_nFillMode','cleScene','fMipLevel','setPerspective','_arrayCleBuffer','TEXTURE_MAG_FILTER','stuAnimSaveDataMgr','_fZFar','cleTextureHeight','result','49939AzSfjc','2XcKCAN','LINEAR_MIPMAP_LINEAR','log','arrImageFile','_arrayByteBuffer','name','NEAREST','TEXTURE_WRAP_T','cleTextureWidth','_uObjectID','_uModelID','loadFromArray','140713BjKVHm','uResID','push','stuConfig','invalid\x20file\x20length\x20','bindSlice','fromCleMaterialIdx','REPEAT','vMaterialMap','computeFocusOnBoxDesc','TEXTURE_WRAP_S','_fZNear','5UQIASU','_arrSubsetMtlID','_stuModelData','from','update','_vUp','materialView','arrModelData','texParameteri','\x20in\x20loacl\x20file\x20','checkModelSupport','unbindSlice','552521nLroRW','115YyX45Lqs5Zyc5pmW5YaF6YOo5byA5Y+R5LiT55So'];(function(_0x170364,_0x4fc1b4){const _0x4abb3e=a89_0x4431;while(!![]){try{const _0x3d5101=-parseInt(_0x4abb3e(0x191))+parseInt(_0x4abb3e(0x1bd))+-parseInt(_0x4abb3e(0x179))*-parseInt(_0x4abb3e(0x1e5))+parseInt(_0x4abb3e(0x1e4))*-parseInt(_0x4abb3e(0x185))+parseInt(_0x4abb3e(0x1a4))+-parseInt(_0x4abb3e(0x19f))*parseInt(_0x4abb3e(0x1a1))+parseInt(_0x4abb3e(0x1b5));if(_0x3d5101===_0x4fc1b4)break;else _0x170364['push'](_0x170364['shift']());}catch(_0x17c235){_0x170364['push'](_0x170364['shift']());}}}(a89_0x2f2f,0x4f1c2));import*as a89_0x2d2ba9 from'../Math/float3.js';import*as a89_0x162d43 from'../Math/box.js';import*as a89_0x306a85 from'../Camera/camera.js';import*as a89_0x7dc193 from'./comm.js';import*as a89_0x1e5a30 from'./material.js';import*as a89_0x12c6d9 from'./mesh.js';export function loadModelFromLocalFile(_0x12c1aa,_0x3ba45a,_0x1369f7){const _0x4d2fe7=a89_0x4431;let _0x1c4c45={'fileName':_0x12c1aa[_0x4d2fe7(0x1ea)],'context':_0x3ba45a,'callback':_0x1369f7};var _0x3ec977=new FileReader();{_0x3ec977['onerror']=function(_0x420189){onLocalFileError(_0x1c4c45,_0x3ec977,_0x420189);},_0x3ec977[_0x4d2fe7(0x1cb)]=function(_0x3ab4e0){onLocalFileLoaded(_0x1c4c45,_0x3ec977,_0x3ab4e0);};}return _0x3ec977[_0x4d2fe7(0x1c1)](_0x12c1aa),_0x1c4c45;}function onLocalFileError(_0xe9e5e2,_0x2be7cd,_0x4c134f){const _0x55ecb6=a89_0x4431;console[_0x55ecb6(0x1e7)](_0x55ecb6(0x195)+_0xe9e5e2[_0x55ecb6(0x1b8)]),_0xe9e5e2['callback'](null);}function onLocalFileLoaded(_0x4eda7b,_0x2e44d8,_0x4f05e5){const _0x10d824=a89_0x4431;let _0x59f3a7=_0x2e44d8[_0x10d824(0x1e3)];if(_0x59f3a7[_0x10d824(0x1d4)]<0xa){console[_0x10d824(0x1e7)](_0x10d824(0x17d)+_0x59f3a7[_0x10d824(0x1d4)]+_0x10d824(0x18e)+_0x4eda7b[_0x10d824(0x1b8)]),_0x4eda7b['callback'](null);return;}g_licData=_0x10d824(0x192),InitModelStream();{g_p3dParser[_0x10d824(0x1e9)]=_0x59f3a7,g_p3dParser['_arrayCleBuffer']=new DataView(_0x59f3a7,0x0,_0x59f3a7[_0x10d824(0x1d4)]),g_p3dParser[_0x10d824(0x1b9)]=_0x59f3a7[_0x10d824(0x1d4)];}let _0x306f8d=ParseCleStream();{g_p3dParser[_0x10d824(0x1de)]=null,g_p3dParser['_arrayByteBuffer']=null;}if(_0x306f8d!==!![]){console[_0x10d824(0x1e7)]('failed\x20to\x20parse\x20data\x20in\x20local\x20file\x20'+_0x4eda7b[_0x10d824(0x1b8)]),_0x4eda7b['callback'](null);return;}let _0x1d804b=fromCleScene(_0x4eda7b[_0x10d824(0x1a0)],g_sceneData);{_0x1d804b[_0x10d824(0x1a2)]=_0x4eda7b[_0x10d824(0x1b8)];}_0x4eda7b['callback'](_0x1d804b);}function a89_0x4431(_0x58e806,_0x30a073){_0x58e806=_0x58e806-0x177;let _0x2f2f53=a89_0x2f2f[_0x58e806];return _0x2f2f53;}function fromCleScene(_0x3e7baa,_0x3d44bb){const _0x491110=a89_0x4431;let _0x4e7c45={'cleScene':_0x3d44bb,'eUpAxis':a89_0x7dc193[_0x491110(0x1a7)](_0x3d44bb[_0x491110(0x17c)]),'bUpAxisNegative':a89_0x7dc193['isUpAxisNegative'](_0x3d44bb[_0x491110(0x17c)]),'bCameraAnimation':_0x3d44bb['stuCameraSaveDataMgr'][_0x491110(0x1d7)][_0x491110(0x196)]>0x0,'uFrameCount':_0x3d44bb[_0x491110(0x1e0)]['_uFrameSize'],'vTextureMap':{},'textureArray':null,'vMaterialArray':new Array(),'vMaterialMap':{},'materialView':null,'vMeshArray':new Array(),'bounds':a89_0x162d43[_0x491110(0x1b1)](),'uWorldAlphaRevision':0x0,'uBoundsRevision':{'update':0x0,'current':0x0}};buildTextureMap(_0x3e7baa,_0x3d44bb,_0x4e7c45),buildMaterialMap(_0x3d44bb,_0x4e7c45),_0x4e7c45[_0x491110(0x18b)]=a89_0x1e5a30['makeView'](_0x3e7baa,_0x4e7c45[_0x491110(0x1b4)]);let _0x4cb742={};{for(const _0xeafe44 of _0x3d44bb[_0x491110(0x1e0)][_0x491110(0x194)]){_0x4cb742[_0xeafe44[_0x491110(0x1ee)]]=_0xeafe44;}}let _0x38216a=_0x3d44bb[_0x491110(0x1c9)];for(const _0xdb45da of _0x3d44bb[_0x491110(0x18c)]){const _0x44da34=_0xdb45da[_0x491110(0x1b2)];if(a89_0x7dc193[_0x491110(0x18f)](_0x44da34[_0x491110(0x187)])){const _0x221011=a89_0x12c6d9[_0x491110(0x188)](_0x3e7baa,_0x44da34,_0x38216a,_0x4cb742,_0x4e7c45['vMaterialMap']);_0x4e7c45[_0x491110(0x1d1)][_0x491110(0x17b)](_0x221011);}else console['log'](_0x491110(0x1d3)+_0x44da34[_0x491110(0x177)]+'\x20'+_0x44da34[_0x491110(0x1b3)]);}return updateBounds(_0x4e7c45),_0x4e7c45;}function buildTextureMap(_0x1d8101,_0x31bca0,_0x8e2ad7){const _0x570114=a89_0x4431;let _0x5dd0c6=0x1,_0x5778e1=0x1,_0x401770=new Array(),_0x144047={};_0x401770[_0x570114(0x17b)](Texture2D[_0x570114(0x1c3)](_0x1d8101,_0x1d8101[_0x570114(0x1d8)],_0x5dd0c6,_0x5778e1,!![]));for(const _0x4c6ed8 of _0x31bca0[_0x570114(0x1e8)]){const _0x36e3dd=_0x4c6ed8['_FileInfo'][_0x570114(0x17a)],_0x15dc2f=_0x4c6ed8['_FileInfo'][_0x570114(0x19a)];for(const _0x5e6de7 of _0x31bca0[_0x570114(0x1cd)]){if(_0x15dc2f==_0x5e6de7['_name']){let _0x22f2a0=_0x144047[_0x15dc2f];if(_0x22f2a0==null){_0x1d8101[_0x570114(0x1d0)](_0x1d8101[_0x570114(0x1ca)],0x1);{_0x22f2a0=Texture2D[_0x570114(0x178)](_0x1d8101,_0x1d8101[_0x570114(0x1d5)],_0x5e6de7[_0x570114(0x1a6)],_0x5e6de7[_0x570114(0x1cc)],_0x5e6de7[_0x570114(0x1d2)],![]);}_0x1d8101[_0x570114(0x1d0)](_0x1d8101[_0x570114(0x1ca)],0x4),_0x144047[_0x15dc2f]=_0x22f2a0,_0x5dd0c6=Math[_0x570114(0x1c5)](_0x5e6de7[_0x570114(0x1a6)],_0x5dd0c6),_0x5778e1=Math[_0x570114(0x1c5)](_0x5e6de7[_0x570114(0x1cc)],_0x5778e1),_0x22f2a0[_0x570114(0x1b6)][_0x570114(0x1bc)]=_0x401770[_0x570114(0x196)],_0x22f2a0['cmonline'][_0x570114(0x1ed)]=_0x5e6de7[_0x570114(0x1a6)],_0x22f2a0[_0x570114(0x1b6)]['cleTextureHeight']=_0x5e6de7[_0x570114(0x1cc)],_0x401770[_0x570114(0x17b)](_0x22f2a0);}_0x8e2ad7['vTextureMap'][_0x36e3dd]=_0x22f2a0[_0x570114(0x1b6)][_0x570114(0x1bc)];break;}}}_0x8e2ad7['textureArray']=composeTextureMap(_0x1d8101,_0x8e2ad7,_0x5dd0c6,_0x5778e1,_0x401770);}function composeTextureMap(_0x4dd654,_0x4cfd95,_0x5c36bf,_0x31a444,_0xbf5de4){const _0x2cef03=a89_0x4431;if(_0xbf5de4[_0x2cef03(0x196)]==0x1)return _0xbf5de4[0x0];let _0x4868b2=RtTexture2DArray['create'](_0x4dd654,_0x5c36bf,_0x31a444,_0xbf5de4[_0x2cef03(0x196)],_0x4dd654['RGBA8'],null),_0xc06f88=Copy[_0x2cef03(0x1b1)](_0x4dd654);{_0xc06f88['bInverseY']=!![],_0xc06f88[_0x2cef03(0x1dc)]=0x0;}for(let _0x2f9940=0x0;_0x2f9940<_0xbf5de4[_0x2cef03(0x196)];++_0x2f9940){RtTexture2DArray[_0x2cef03(0x17e)](_0x4868b2,_0x2f9940);{let _0x1e9b37=_0xbf5de4[_0x2f9940];_0x4dd654['bindTexture'](_0x4dd654[_0x2cef03(0x1a3)],_0x1e9b37);{_0x1e9b37[_0x2cef03(0x1b6)][_0x2cef03(0x1ed)]!=_0x5c36bf||_0x1e9b37[_0x2cef03(0x1b6)][_0x2cef03(0x1e2)]!=_0x31a444?(_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654[_0x2cef03(0x1d9)],_0x4dd654[_0x2cef03(0x1eb)]),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654[_0x2cef03(0x1df)],_0x4dd654[_0x2cef03(0x1c4)])):(_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654[_0x2cef03(0x1d9)],_0x4dd654[_0x2cef03(0x1eb)]),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654[_0x2cef03(0x1df)],_0x4dd654[_0x2cef03(0x1eb)])),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654[_0x2cef03(0x183)],_0x4dd654[_0x2cef03(0x1a8)]),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a3)],_0x4dd654['TEXTURE_WRAP_T'],_0x4dd654[_0x2cef03(0x1a8)]);}_0x4dd654[_0x2cef03(0x1b7)](_0x4dd654[_0x2cef03(0x1a3)],null),_0xc06f88['texture']=_0x1e9b37,_0xc06f88[_0x2cef03(0x19e)](_0x4868b2[_0x2cef03(0x1ac)]);}RtTexture2DArray[_0x2cef03(0x190)](_0x4868b2,_0x2f9940);}_0x4dd654[_0x2cef03(0x1b7)](_0x4dd654['TEXTURE_2D_ARRAY'],_0x4868b2['textureColor']);{_0x4dd654[_0x2cef03(0x19c)](_0x4dd654['TEXTURE_2D_ARRAY']),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654['TEXTURE_2D_ARRAY'],_0x4dd654[_0x2cef03(0x1d9)],_0x4dd654[_0x2cef03(0x1e6)]),_0x4dd654['texParameteri'](_0x4dd654[_0x2cef03(0x1a9)],_0x4dd654['TEXTURE_MAG_FILTER'],_0x4dd654['LINEAR']),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a9)],_0x4dd654[_0x2cef03(0x183)],_0x4dd654[_0x2cef03(0x180)]),_0x4dd654['texParameteri'](_0x4dd654[_0x2cef03(0x1a9)],_0x4dd654[_0x2cef03(0x1ec)],_0x4dd654[_0x2cef03(0x180)]),_0x4dd654[_0x2cef03(0x18d)](_0x4dd654[_0x2cef03(0x1a9)],_0x4dd654[_0x2cef03(0x1ad)],_0x4dd654['CLAMP_TO_EDGE']);}return _0x4dd654[_0x2cef03(0x1b7)](_0x4dd654[_0x2cef03(0x1a3)],null),_0x4868b2['textureColor'];}function buildMaterialMap(_0x474fd2,_0x2e19bb){const _0x5bbeec=a89_0x4431;for(const _0x127d43 of _0x474fd2[_0x5bbeec(0x1c0)][_0x5bbeec(0x199)]){const _0x3d9198=a89_0x1e5a30['fromCleMaterial'](_0x127d43,_0x2e19bb[_0x5bbeec(0x1be)]);{_0x3d9198[_0x5bbeec(0x1c8)]=_0x2e19bb['vMaterialArray'][_0x5bbeec(0x196)];}_0x2e19bb[_0x5bbeec(0x1b4)]['push'](_0x3d9198),_0x2e19bb[_0x5bbeec(0x181)][_0x127d43['_uMtlID']]=_0x3d9198;}let _0x547e73=_0x474fd2[_0x5bbeec(0x1c9)];for(const _0x540298 of _0x547e73[_0x5bbeec(0x1c6)]){if(_0x540298[_0x5bbeec(0x1da)]!=ADFFILL_SOLID)continue;for(const _0x20a2ec of _0x540298[_0x5bbeec(0x186)]){if(_0x2e19bb[_0x5bbeec(0x181)][_0x20a2ec]!=null)continue;const _0x9dc5a4=a89_0x1e5a30[_0x5bbeec(0x17f)](_0x20a2ec);{_0x9dc5a4[_0x5bbeec(0x1c8)]=_0x2e19bb[_0x5bbeec(0x1b4)]['length'];}_0x2e19bb['vMaterialArray'][_0x5bbeec(0x17b)](_0x9dc5a4),_0x2e19bb['vMaterialMap'][_0x20a2ec]=_0x9dc5a4;}}}export function getBounds(_0x1915d8){const _0x11552b=a89_0x4431;return _0x1915d8[_0x11552b(0x198)][_0x11552b(0x189)]!=_0x1915d8[_0x11552b(0x198)][_0x11552b(0x1cf)]&&(updateBounds(_0x1915d8),_0x1915d8[_0x11552b(0x198)][_0x11552b(0x189)]=_0x1915d8[_0x11552b(0x198)][_0x11552b(0x1cf)]),_0x1915d8[_0x11552b(0x19d)];}export function updateBounds(_0x13d0e5){const _0x2c10f9=a89_0x4431;a89_0x162d43['setEmpty'](_0x13d0e5[_0x2c10f9(0x19d)]);for(const _0x16991a of _0x13d0e5['vMeshArray']){a89_0x12c6d9[_0x2c10f9(0x1af)](_0x16991a,_0x13d0e5['bounds']);}}export function computeDefaultCamera(_0x51e46d,_0x4ee943){const _0x176b68=a89_0x4431,_0xf5232b=_0x51e46d[_0x176b68(0x1db)],_0x15837c=_0xf5232b[_0x176b68(0x193)][_0x176b68(0x1b0)],_0x27233a=a89_0x7dc193['unitToScaleFactor'](_0xf5232b[_0x176b68(0x17c)][_0x176b68(0x1aa)][_0x176b68(0x1bf)]);if(a89_0x7dc193[_0x176b68(0x1c7)](_0xf5232b))a89_0x306a85['setViewParam'](_0x4ee943,a89_0x7dc193[_0x176b68(0x1bb)](null,_0x15837c[_0x176b68(0x1d6)]),a89_0x7dc193[_0x176b68(0x1bb)](null,_0x15837c[_0x176b68(0x1ce)]),a89_0x7dc193[_0x176b68(0x1bb)](null,_0x15837c[_0x176b68(0x18a)])),a89_0x306a85[_0x176b68(0x1dd)](_0x4ee943,_0x15837c[_0x176b68(0x1ba)],_0x4ee943[_0x176b68(0x1c2)][_0x176b68(0x19b)],_0x15837c[_0x176b68(0x184)],_0x15837c[_0x176b68(0x1e1)]);else{a89_0x306a85[_0x176b68(0x1ae)](_0x4ee943,a89_0x2d2ba9['from'](_0x27233a,_0x27233a,_0x27233a),a89_0x2d2ba9[_0x176b68(0x188)](0x0,0x0,0x0),a89_0x2d2ba9[_0x176b68(0x1ab)](_0x51e46d[_0x176b68(0x197)])),a89_0x306a85[_0x176b68(0x1dd)](_0x4ee943,0.85171175,_0x4ee943[_0x176b68(0x1c2)]['fAspect'],_0x27233a*0.01,_0x27233a*0x3e8);let _0x3adf7d=a89_0x306a85[_0x176b68(0x182)](_0x4ee943,_0x51e46d['bounds']);a89_0x306a85['updateDesc'](_0x4ee943,_0x3adf7d);}}export function computeCameraDescAtFrame(_0x5c07a2,_0x48a702,_0x4e5603){const _0x4a88d8=a89_0x4431;let _0x5834c1=new ADF_CAMERA();return CalculateCameraDataByKeyFrame(_0x4e5603,_0x48a702[_0x4a88d8(0x1db)][_0x4a88d8(0x193)][_0x4a88d8(0x1d7)],_0x5834c1),a89_0x7dc193[_0x4a88d8(0x1a5)](_0x5c07a2,_0x5834c1);}