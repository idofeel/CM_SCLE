'use strict';const a82_0xedd6=['_stuModelData','398353dbVJRu','TEXTURE_WRAP_T','stuObjSaveDataMgr','uResID','setPerspective','24848yCaMEF','_ModelInfo','desc','_arrSubsetMtlID','_arrCameraAnimSaveData','_imageWidth','vMaterialMap','_vUp','_nLengthUnit','_nCleBufferlength','bindSlice','_fZNear','eUpAxis','from','TEXTURE_2D','invalid\x20file\x20length\x20','makeAxis','118025cJTCBZ','_fZFar','fMipLevel','make','pixelStorei','_uObjectID','539977QGRNAO','result','callback','isUpAxisNegative','1689697CVKvrG','vTextureMap','LINEAR_MIPMAP_LINEAR','REPEAT','failed\x20to\x20open\x20local\x20file:\x20','uPos','byteLength','fromCleVec3','fileName','vMeshArray','18mvTpjY','_arrayCleBuffer','unitToScaleFactor','NEAREST','updateBounds','loadFromArray','update','stuMtlSaveDataMgr','localFileName','vMaterialArray','textureArray','stuCameraSaveDataMgr','cleTextureHeight','strFileName','checkModelSupport','SRGB8','onerror','_arrObjAnimSaveData','current','CLAMP_TO_EDGE','push','UNPACK_ALIGNMENT','failed\x20to\x20parse\x20data\x20in\x20local\x20file\x20','meet\x20a\x20unsupport\x20model\x20','checkIfDefaultCameraValid','materialView','600176xISFoK','_strModelName','texParameteri','_name','setViewParam','readAsArrayBuffer','264007nkPgGl','fromCleMaterialIdx','bounds','_FileInfo','TEXTURE_MAG_FILTER','stuAnimSaveDataMgr','uBoundsRevision','_imageHeight','TEXTURE_WRAP_S','fromCleCamera','setEmpty','texture','_arrObjSaveData','cleTextureWidth','_imageData','length','_uMtlID','name','_uModelID','log','getUpAxis','TEXTURE_MIN_FILTER','fAspect','generateMipmap','cmonline','onload','cleScene','1bDJYwQ','LINEAR','115YyX45Lqs5Zyc5pmW5YaF6YOo5byA5Y+R5LiT55So','TEXTURE_2D_ARRAY','_uFrameSize','render','RGBA8','_arrayByteBuffer','_vFocus','stuConfig','bindTexture','max','cleTexturePos','create'];(function(_0x5b4250,_0x20de12){const _0x2b73d8=a82_0x4fd2;while(!![]){try{const _0x27bf19=-parseInt(_0x2b73d8(0x136))+-parseInt(_0x2b73d8(0x108))+parseInt(_0x2b73d8(0x102))+parseInt(_0x2b73d8(0xec))+-parseInt(_0x2b73d8(0x130))+-parseInt(_0x2b73d8(0xf1))*parseInt(_0x2b73d8(0x116))+parseInt(_0x2b73d8(0x151))*parseInt(_0x2b73d8(0x10c));if(_0x27bf19===_0x20de12)break;else _0x5b4250['push'](_0x5b4250['shift']());}catch(_0x4fb129){_0x5b4250['push'](_0x5b4250['shift']());}}}(a82_0xedd6,0x5695b));import*as a82_0x3dd4e7 from'../Math/float3.js';import*as a82_0x16207e from'../Math/box.js';import*as a82_0x75d881 from'../Camera/Camera.js';import*as a82_0x5a7f8b from'./Comm.js';import*as a82_0x5d4b16 from'./Mesh.js';export function loadModelFromLocalFile(_0x118ff1,_0x4d4344,_0x1c5a43){const _0x5a04f7=a82_0x4fd2;let _0x216a9c={'fileName':_0x118ff1[_0x5a04f7(0x147)],'context':_0x4d4344,'callback':_0x1c5a43};var _0x37750c=new FileReader();{_0x37750c[_0x5a04f7(0x126)]=function(_0x1ffdc6){onLocalFileError(_0x216a9c,_0x37750c,_0x1ffdc6);},_0x37750c[_0x5a04f7(0x14f)]=function(_0x875e58){onLocalFileLoaded(_0x216a9c,_0x37750c,_0x875e58);};}return _0x37750c[_0x5a04f7(0x135)](_0x118ff1),_0x216a9c;}function onLocalFileError(_0x5e93cc,_0x33d836,_0x4eb2ae){const _0x203a44=a82_0x4fd2;console['log'](_0x203a44(0x110)+_0x5e93cc[_0x203a44(0x114)]),_0x5e93cc['callback'](null);}function onLocalFileLoaded(_0xa02c25,_0xdd94f4,_0x331d30){const _0x3cf45f=a82_0x4fd2;let _0x294a26=_0xdd94f4[_0x3cf45f(0x109)];if(_0x294a26[_0x3cf45f(0x112)]<0xa){console['log'](_0x3cf45f(0x100)+_0x294a26[_0x3cf45f(0x112)]+'\x20in\x20loacl\x20file\x20'+_0xa02c25[_0x3cf45f(0x114)]),_0xa02c25[_0x3cf45f(0x10a)](null);return;}g_licData=_0x3cf45f(0x153),InitModelStream();{g_p3dParser[_0x3cf45f(0x158)]=_0x294a26,g_p3dParser[_0x3cf45f(0x117)]=new DataView(_0x294a26,0x0,_0x294a26[_0x3cf45f(0x112)]),g_p3dParser[_0x3cf45f(0xfa)]=_0x294a26['byteLength'];}let _0x520e33=ParseCleStream();{g_p3dParser[_0x3cf45f(0x117)]=null,g_p3dParser[_0x3cf45f(0x158)]=null;}if(_0x520e33!==!![]){console[_0x3cf45f(0x149)](_0x3cf45f(0x12c)+_0xa02c25[_0x3cf45f(0x114)]),_0xa02c25[_0x3cf45f(0x10a)](null);return;}let _0xb95757=fromCleScene(_0xa02c25['context'],g_sceneData);{_0xb95757[_0x3cf45f(0x11e)]=_0xa02c25[_0x3cf45f(0x114)];}_0xa02c25[_0x3cf45f(0x10a)](_0xb95757);}function fromCleScene(_0x1d200c,_0x4ea061){const _0x2460f7=a82_0x4fd2;let _0x565d8f={'cleScene':_0x4ea061,'eUpAxis':a82_0x5a7f8b[_0x2460f7(0x14a)](_0x4ea061[_0x2460f7(0x15a)]),'bUpAxisNegative':a82_0x5a7f8b[_0x2460f7(0x10b)](_0x4ea061[_0x2460f7(0x15a)]),'bCameraAnimation':_0x4ea061[_0x2460f7(0x121)][_0x2460f7(0xf5)][_0x2460f7(0x145)]>0x0,'uFrameCount':_0x4ea061[_0x2460f7(0x13b)][_0x2460f7(0x155)],'vTextureMap':{},'textureArray':null,'vMaterialArray':new Array(),'vMaterialMap':{},'materialView':null,'vMeshArray':new Array(),'bounds':a82_0x16207e[_0x2460f7(0x105)](),'uWorldAlphaRevision':0x0,'uBoundsRevision':{'update':0x0,'current':0x0}};buildTextureMap(_0x1d200c,_0x4ea061,_0x565d8f),buildMaterialMap(_0x4ea061,_0x565d8f),_0x565d8f[_0x2460f7(0x12f)]=Material['makeView'](_0x1d200c,_0x565d8f['vMaterialArray']);let _0x5f24d7={};{for(const _0x83b2de of _0x4ea061[_0x2460f7(0x13b)][_0x2460f7(0x127)]){_0x5f24d7[_0x83b2de[_0x2460f7(0x107)]]=_0x83b2de;}}let _0x25cc62=_0x4ea061[_0x2460f7(0xee)];for(const _0x7e1f83 of _0x4ea061['arrModelData']){const _0x4f1581=_0x7e1f83[_0x2460f7(0xf2)];if(a82_0x5a7f8b[_0x2460f7(0x124)](_0x4f1581[_0x2460f7(0xeb)])){const _0x1abfc3=a82_0x5d4b16[_0x2460f7(0xfe)](_0x1d200c,_0x4f1581,_0x25cc62,_0x5f24d7,_0x565d8f[_0x2460f7(0xf7)]);_0x565d8f[_0x2460f7(0x115)][_0x2460f7(0x12a)](_0x1abfc3);}else console[_0x2460f7(0x149)](_0x2460f7(0x12d)+_0x4f1581[_0x2460f7(0x148)]+'\x20'+_0x4f1581[_0x2460f7(0x131)]);}return updateBounds(_0x565d8f),_0x565d8f;}function buildTextureMap(_0xb156fd,_0x247894,_0x4b6d26){const _0x73795b=a82_0x4fd2;let _0x2b1aa3=0x1,_0x506901=0x1,_0x195015=new Array(),_0x5b0af4={};_0x195015[_0x73795b(0x12a)](Texture2D[_0x73795b(0xea)](_0xb156fd,_0xb156fd['RGBA8'],_0x2b1aa3,_0x506901,!![]));for(const _0x42c25e of _0x247894['arrImageFile']){const _0x36ebf7=_0x42c25e[_0x73795b(0x139)][_0x73795b(0xef)],_0x17e79c=_0x42c25e[_0x73795b(0x139)][_0x73795b(0x123)];for(const _0x1c40b8 of _0x247894['arrResFile']){if(_0x17e79c==_0x1c40b8[_0x73795b(0x133)]){let _0x4e942a=_0x5b0af4[_0x17e79c];if(_0x4e942a==null){_0xb156fd[_0x73795b(0x106)](_0xb156fd[_0x73795b(0x12b)],0x1);{_0x4e942a=Texture2D[_0x73795b(0x11b)](_0xb156fd,_0xb156fd[_0x73795b(0x125)],_0x1c40b8['_imageWidth'],_0x1c40b8[_0x73795b(0x13d)],_0x1c40b8[_0x73795b(0x144)],![]);}_0xb156fd[_0x73795b(0x106)](_0xb156fd[_0x73795b(0x12b)],0x4),_0x5b0af4[_0x17e79c]=_0x4e942a,_0x2b1aa3=Math[_0x73795b(0x15c)](_0x1c40b8[_0x73795b(0xf6)],_0x2b1aa3),_0x506901=Math['max'](_0x1c40b8[_0x73795b(0x13d)],_0x506901),_0x4e942a[_0x73795b(0x14e)][_0x73795b(0x15d)]=_0x195015[_0x73795b(0x145)],_0x4e942a[_0x73795b(0x14e)][_0x73795b(0x143)]=_0x1c40b8[_0x73795b(0xf6)],_0x4e942a['cmonline'][_0x73795b(0x122)]=_0x1c40b8[_0x73795b(0x13d)],_0x195015[_0x73795b(0x12a)](_0x4e942a);}_0x4b6d26['vTextureMap'][_0x36ebf7]=_0x4e942a[_0x73795b(0x14e)][_0x73795b(0x15d)];break;}}}_0x4b6d26[_0x73795b(0x120)]=composeTextureMap(_0xb156fd,_0x4b6d26,_0x2b1aa3,_0x506901,_0x195015);}function composeTextureMap(_0x2cd528,_0x4f85ad,_0x4e7920,_0x164f43,_0x5bafb1){const _0x20e640=a82_0x4fd2;if(_0x5bafb1[_0x20e640(0x145)]==0x1)return _0x5bafb1[0x0];let _0x19b585=RtTexture2DArray[_0x20e640(0xea)](_0x2cd528,_0x4e7920,_0x164f43,_0x5bafb1['length'],_0x2cd528[_0x20e640(0x157)],null),_0x168017=Copy[_0x20e640(0x105)](_0x2cd528);{_0x168017['bInverseY']=!![],_0x168017[_0x20e640(0x104)]=0x0;}for(let _0x56bf04=0x0;_0x56bf04<_0x5bafb1[_0x20e640(0x145)];++_0x56bf04){RtTexture2DArray[_0x20e640(0xfb)](_0x19b585,_0x56bf04);{let _0x110a48=_0x5bafb1[_0x56bf04];_0x2cd528['bindTexture'](_0x2cd528[_0x20e640(0xff)],_0x110a48);{_0x110a48['cmonline'][_0x20e640(0x143)]!=_0x4e7920||_0x110a48[_0x20e640(0x14e)][_0x20e640(0x122)]!=_0x164f43?(_0x2cd528['texParameteri'](_0x2cd528[_0x20e640(0xff)],_0x2cd528[_0x20e640(0x14b)],_0x2cd528[_0x20e640(0x119)]),_0x2cd528[_0x20e640(0x132)](_0x2cd528['TEXTURE_2D'],_0x2cd528[_0x20e640(0x13a)],_0x2cd528['LINEAR'])):(_0x2cd528[_0x20e640(0x132)](_0x2cd528['TEXTURE_2D'],_0x2cd528[_0x20e640(0x14b)],_0x2cd528['NEAREST']),_0x2cd528['texParameteri'](_0x2cd528[_0x20e640(0xff)],_0x2cd528['TEXTURE_MAG_FILTER'],_0x2cd528[_0x20e640(0x119)])),_0x2cd528['texParameteri'](_0x2cd528['TEXTURE_2D'],_0x2cd528[_0x20e640(0x13e)],_0x2cd528['CLAMP_TO_EDGE']),_0x2cd528['texParameteri'](_0x2cd528[_0x20e640(0xff)],_0x2cd528[_0x20e640(0xed)],_0x2cd528['CLAMP_TO_EDGE']);}_0x2cd528['bindTexture'](_0x2cd528[_0x20e640(0xff)],null),_0x168017[_0x20e640(0x141)]=_0x110a48,_0x168017[_0x20e640(0x156)](_0x19b585['viewport']);}RtTexture2DArray['unbindSlice'](_0x19b585,_0x56bf04);}_0x2cd528[_0x20e640(0x15b)](_0x2cd528['TEXTURE_2D_ARRAY'],_0x19b585['textureColor']);{_0x2cd528[_0x20e640(0x14d)](_0x2cd528[_0x20e640(0x154)]),_0x2cd528['texParameteri'](_0x2cd528[_0x20e640(0x154)],_0x2cd528[_0x20e640(0x14b)],_0x2cd528[_0x20e640(0x10e)]),_0x2cd528[_0x20e640(0x132)](_0x2cd528[_0x20e640(0x154)],_0x2cd528[_0x20e640(0x13a)],_0x2cd528[_0x20e640(0x152)]),_0x2cd528[_0x20e640(0x132)](_0x2cd528[_0x20e640(0x154)],_0x2cd528[_0x20e640(0x13e)],_0x2cd528['REPEAT']),_0x2cd528[_0x20e640(0x132)](_0x2cd528[_0x20e640(0x154)],_0x2cd528[_0x20e640(0xed)],_0x2cd528[_0x20e640(0x10f)]),_0x2cd528[_0x20e640(0x132)](_0x2cd528['TEXTURE_2D_ARRAY'],_0x2cd528['TEXTURE_WRAP_R'],_0x2cd528[_0x20e640(0x129)]);}return _0x2cd528[_0x20e640(0x15b)](_0x2cd528[_0x20e640(0xff)],null),_0x19b585['textureColor'];}function buildMaterialMap(_0x42f0d3,_0x30704d){const _0x36733b=a82_0x4fd2;for(const _0x4a2210 of _0x42f0d3[_0x36733b(0x11d)]['_arrMtlSaveData']){const _0x436023=Material['fromCleMaterial'](_0x4a2210,_0x30704d[_0x36733b(0x10d)]);{_0x436023['uPos']=_0x30704d['vMaterialArray'][_0x36733b(0x145)];}_0x30704d[_0x36733b(0x11f)]['push'](_0x436023),_0x30704d[_0x36733b(0xf7)][_0x4a2210[_0x36733b(0x146)]]=_0x436023;}let _0x23a59f=_0x42f0d3['stuObjSaveDataMgr'];for(const _0x139125 of _0x23a59f[_0x36733b(0x142)]){if(_0x139125['_nFillMode']!=ADFFILL_SOLID)continue;for(const _0x47aa2c of _0x139125[_0x36733b(0xf4)]){if(_0x30704d['vMaterialMap'][_0x47aa2c]!=null)continue;const _0x4e0120=Material[_0x36733b(0x137)](_0x47aa2c);{_0x4e0120[_0x36733b(0x111)]=_0x30704d['vMaterialArray'][_0x36733b(0x145)];}_0x30704d[_0x36733b(0x11f)]['push'](_0x4e0120),_0x30704d['vMaterialMap'][_0x47aa2c]=_0x4e0120;}}}export function getBounds(_0x4983db){const _0xe71e96=a82_0x4fd2;return _0x4983db[_0xe71e96(0x13c)][_0xe71e96(0x11c)]!=_0x4983db[_0xe71e96(0x13c)]['current']&&(updateBounds(_0x4983db),_0x4983db[_0xe71e96(0x13c)][_0xe71e96(0x11c)]=_0x4983db[_0xe71e96(0x13c)][_0xe71e96(0x128)]),_0x4983db[_0xe71e96(0x138)];}export function updateBounds(_0x147270){const _0xfb6c00=a82_0x4fd2;a82_0x16207e[_0xfb6c00(0x140)](_0x147270[_0xfb6c00(0x138)]);for(const _0x12c8a1 of _0x147270[_0xfb6c00(0x115)]){a82_0x5d4b16[_0xfb6c00(0x11a)](_0x12c8a1,_0x147270[_0xfb6c00(0x138)]);}}export function computeDefaultCamera(_0x54c237,_0x2241eb){const _0x5251ea=a82_0x4fd2,_0x57cf01=_0x54c237[_0x5251ea(0x150)],_0x3d254f=_0x57cf01[_0x5251ea(0x121)]['_DefaultCamera'],_0x3e795b=a82_0x5a7f8b[_0x5251ea(0x118)](_0x57cf01[_0x5251ea(0x15a)]['_stuSceneUnit'][_0x5251ea(0xf9)]);if(a82_0x5a7f8b[_0x5251ea(0x12e)](_0x57cf01))a82_0x75d881[_0x5251ea(0x134)](_0x2241eb,a82_0x5a7f8b[_0x5251ea(0x113)](null,_0x3d254f['_vEyePos']),a82_0x5a7f8b[_0x5251ea(0x113)](null,_0x3d254f[_0x5251ea(0x159)]),a82_0x5a7f8b['fromCleVec3'](null,_0x3d254f[_0x5251ea(0xf8)])),a82_0x75d881['setPerspective'](_0x2241eb,_0x3d254f['_fFOVY'],_0x2241eb[_0x5251ea(0xf3)]['fAspect'],_0x3d254f[_0x5251ea(0xfc)],_0x3d254f[_0x5251ea(0x103)]);else{a82_0x75d881[_0x5251ea(0x134)](_0x2241eb,a82_0x3dd4e7['from'](_0x3e795b,_0x3e795b,_0x3e795b),a82_0x3dd4e7[_0x5251ea(0xfe)](0x0,0x0,0x0),a82_0x3dd4e7[_0x5251ea(0x101)](_0x54c237[_0x5251ea(0xfd)])),a82_0x75d881[_0x5251ea(0xf0)](_0x2241eb,0.85171175,_0x2241eb[_0x5251ea(0xf3)][_0x5251ea(0x14c)],_0x3e795b*0.01,_0x3e795b*0x3e8);let _0x42bdb8=a82_0x75d881['computeFocusOnBoxDesc'](_0x2241eb,_0x54c237[_0x5251ea(0x138)]);a82_0x75d881['updateDesc'](_0x2241eb,_0x42bdb8);}}function a82_0x4fd2(_0x55be11,_0x2b0154){_0x55be11=_0x55be11-0xea;let _0xedd684=a82_0xedd6[_0x55be11];return _0xedd684;}export function computeCameraDescAtFrame(_0x4fdc86,_0x50302a,_0x2b1f59){const _0x1bcff1=a82_0x4fd2;let _0x4e4f65=new ADF_CAMERA();return CalculateCameraDataByKeyFrame(_0x2b1f59,_0x50302a['cleScene'][_0x1bcff1(0x121)]['_arrCameraAnimSaveData'],_0x4e4f65),a82_0x5a7f8b[_0x1bcff1(0x13f)](_0x4fdc86,_0x4e4f65);}