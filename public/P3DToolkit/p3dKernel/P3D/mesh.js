'use strict';const a81_0x76e8=['uWorldAlphaRevision','cleObjAnimationArray','fromCleMatrix','uploadArrayData','uObjCount','mul','2lfMqWB','bContainUV','transform','550ucqWHj','invalid\x20material\x20index\x20','merge','getArrayData','vWorldMatrixArray','LogicError','createStaticVertexBuffer','vBuffer','vFlagArray','createStaticIndexBuffer','vWorldITMatrixArray','fromCleBox','length','_arrKeyFrameData','transparentView','_matLocal','inverseTranspose','151144oWWfbG','fill','iBuffer','_arrObjSaveData','textureMaterialPos','_matWorld','cleObjectArray','bounds','_uMeshID','_uIndexCount','push','_arrTranspKeyFrm','_arrVertexData','433931mVwOyK','_uStartIndex','_arrSubsetMtlID','vAlphaArray','textureWorld','createForFloatArray','_uModelID','2RUsoRt','xyz<n','make','121043XDBxGX','_uObjectID','211855QJvMCW','textureAlpha','textureWorldIT','uIndex','_stuModelData','_arrSubset','toTextureFloatArray','279YiQVMp','2175KXJDYJ','_arrIndexData','213821GdPzXT','view','alpha','_uIsUV','solidView','textureObjPos','cleModel','uPos','100GsESXU'];(function(_0x575dc6,_0x5342aa){const _0x2b37af=a81_0x5a78;while(!![]){try{const _0x69ffec=parseInt(_0x2b37af(0x12d))*parseInt(_0x2b37af(0x11e))+parseInt(_0x2b37af(0x141))+-parseInt(_0x2b37af(0x126))*-parseInt(_0x2b37af(0x11c))+-parseInt(_0x2b37af(0x11b))*parseInt(_0x2b37af(0x130))+parseInt(_0x2b37af(0x15a))+-parseInt(_0x2b37af(0x158))*-parseInt(_0x2b37af(0x155))+-parseInt(_0x2b37af(0x14e));if(_0x69ffec===_0x5342aa)break;else _0x575dc6['push'](_0x575dc6['shift']());}catch(_0x10ed72){_0x575dc6['push'](_0x575dc6['shift']());}}}(a81_0x76e8,0xa1d3e));import*as a81_0x404924 from'../Math/math.js';import*as a81_0x53edc2 from'../Math/matrix.js';import*as a81_0x40e804 from'../Math/box.js';import*as a81_0x29a196 from'./P3DComm.js';export function from(_0x49c1e2,_0x4f4be3,_0x2dd5c3,_0x5915cf,_0x387e4e){const _0xb23c70=a81_0x5a78;let _0x335ea1={'uIndex':_0x4f4be3[_0xb23c70(0x154)],'cleModel':_0x4f4be3,'bounds':a81_0x29a196[_0xb23c70(0x13b)](null,_0x4f4be3[_0xb23c70(0x15e)]['_box']),'bContainUV':![],'cleObjectArray':new Array(),'cleObjAnimationArray':new Array(),'vFlagArray':new Array(),'vWorldMatrixArray':null,'vWorldITMatrixArray':null,'vAlphaArray':null,'vBuffer':null,'vSubsetBuffer':null,'iBuffer':null,'view':null,'solidView':null,'transparentView':null,'uWorldAlphaRevision':0x0},_0x124f08=_0x4f4be3['_stuModelData'];_0x335ea1[_0xb23c70(0x12e)]=_0x124f08[_0xb23c70(0x121)]===0x1,_0x335ea1[_0xb23c70(0x137)]=Buffer[_0xb23c70(0x136)](_0x49c1e2,_0x124f08[_0xb23c70(0x14d)],_0x335ea1[_0xb23c70(0x12e)]?'xyz<n<uv':_0xb23c70(0x156)),_0x335ea1['vSubsetBuffer']=buildVertexSubsetIndex(_0x49c1e2,_0x4f4be3),_0x335ea1[_0xb23c70(0x143)]=Buffer[_0xb23c70(0x139)](_0x49c1e2,_0x124f08[_0xb23c70(0x11d)]);const _0x447c0d=_0x335ea1[_0xb23c70(0x15d)];for(const _0x2a169a of _0x2dd5c3[_0xb23c70(0x144)]){if(_0x2a169a['_nFillMode']!=ADFFILL_SOLID)continue;if(_0x2a169a[_0xb23c70(0x149)]==_0x447c0d){let _0x47168e=computeSubsetFlag(_0x4f4be3,_0x2a169a,_0x387e4e);_0x335ea1[_0xb23c70(0x147)]['push'](_0x2a169a),_0x335ea1['cleObjAnimationArray']['push'](_0x5915cf[_0x2a169a[_0xb23c70(0x159)]]),_0x335ea1[_0xb23c70(0x138)][_0xb23c70(0x14b)](_0x47168e);}}return _0x335ea1[_0xb23c70(0x134)]=new Array(_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)]),_0x335ea1[_0xb23c70(0x13a)]=new Array(_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)]),_0x335ea1[_0xb23c70(0x151)]=new Array(_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)])[_0xb23c70(0x142)](0x1),_0x335ea1[_0xb23c70(0x11f)]=makeView(_0x49c1e2,_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)],_0x4f4be3['_stuModelData'][_0xb23c70(0x15f)][_0xb23c70(0x13c)]),_0x335ea1[_0xb23c70(0x122)]=makeObjectView(_0x49c1e2,_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)]),_0x335ea1['transparentView']=makeObjectView(_0x49c1e2,_0x335ea1[_0xb23c70(0x147)][_0xb23c70(0x13c)]),initWorldMatrixAndAlpha(_0x335ea1),updateObjSubsetView(_0x335ea1,_0x387e4e),_0x335ea1;}function a81_0x5a78(_0x5a63eb,_0x589a94){_0x5a63eb=_0x5a63eb-0x11b;let _0x76e805=a81_0x76e8[_0x5a63eb];return _0x76e805;}function buildVertexSubsetIndex(_0x2d7bda,_0x146a3c){const _0x5c2936=a81_0x5a78;let _0x18222f=_0x146a3c[_0x5c2936(0x15e)],_0x39211d=new Array(_0x18222f[_0x5c2936(0x14d)][_0x5c2936(0x13c)]/(_0x18222f[_0x5c2936(0x121)]===0x1?0x8:0x6));if(_0x146a3c[_0x5c2936(0x15e)][_0x5c2936(0x15f)][_0x5c2936(0x13c)]>0x1)for(let _0x1ce8fd=0x0;_0x1ce8fd<_0x146a3c['_stuModelData']['_arrSubset'][_0x5c2936(0x13c)];++_0x1ce8fd){let _0x3f2a47=_0x146a3c[_0x5c2936(0x15e)][_0x5c2936(0x15f)][_0x1ce8fd][_0x5c2936(0x14f)],_0x2e21a4=_0x146a3c[_0x5c2936(0x15e)][_0x5c2936(0x15f)][_0x1ce8fd][_0x5c2936(0x14a)];for(let _0x215f4c=0x0;_0x215f4c<_0x2e21a4;++_0x215f4c){let _0xe319ce=_0x3f2a47+_0x215f4c,_0x1855ae=_0x18222f['_arrIndexData'][_0xe319ce];_0x39211d[_0x1855ae]=_0x1ce8fd;}}else _0x39211d[_0x5c2936(0x142)](0x0);return Buffer['createStaticVertexBuffer'](_0x2d7bda,new Float32Array(_0x39211d),'i1');}function computeSubsetFlag(_0x29599b,_0xb5a696,_0x33fae6){const _0x1b60ff=a81_0x5a78;let _0x1edcfe=0x0;if(_0x29599b[_0x1b60ff(0x15e)]['_arrSubset'][_0x1b60ff(0x13c)]>0x1&&_0x29599b[_0x1b60ff(0x15e)][_0x1b60ff(0x15f)][_0x1b60ff(0x13c)]==_0xb5a696[_0x1b60ff(0x150)][_0x1b60ff(0x13c)]){let _0x5d78ab=0x0,_0x31bfbb=0x0;for(let _0x2faf4e=0x0;_0x2faf4e<_0xb5a696[_0x1b60ff(0x150)][_0x1b60ff(0x13c)];++_0x2faf4e){let _0x35e26e=_0xb5a696['_arrSubsetMtlID'][_0x2faf4e],_0x219117=_0x33fae6[_0x35e26e];if(_0x219117==null)throw new error[(_0x1b60ff(0x135))](_0x1b60ff(0x131)+_0x35e26e);_0x219117[_0x1b60ff(0x120)]<0x1?_0x31bfbb++:_0x5d78ab++;}if(_0x5d78ab==_0xb5a696[_0x1b60ff(0x150)][_0x1b60ff(0x13c)])_0x1edcfe=-0x1;else _0x31bfbb==_0xb5a696[_0x1b60ff(0x150)][_0x1b60ff(0x13c)]&&(_0x1edcfe=0x1);}else{let _0x51da99=0x0;_0xb5a696['_arrSubsetMtlID'][_0x1b60ff(0x13c)]>0x0&&(_0x51da99=_0xb5a696[_0x1b60ff(0x150)][0x0]);let _0x2832e2=_0x33fae6[_0x51da99];if(_0x2832e2==null)throw new error[(_0x1b60ff(0x135))]('invalid\x20material\x20index\x20'+_0x51da99);_0x1edcfe=_0x2832e2[_0x1b60ff(0x120)]<0x1?0x1:-0x1;}return _0x1edcfe;}export function initWorldMatrixAndAlpha(_0x4b9d67){const _0x5e74b8=a81_0x5a78;resetMeshObjectView(_0x4b9d67);let _0xaff8c=new ADF_BASEMATRIX(),_0x168175=Texture2D[_0x5e74b8(0x133)](_0x4b9d67['view'][_0x5e74b8(0x152)]),_0x1cfa80=Texture2D[_0x5e74b8(0x133)](_0x4b9d67[_0x5e74b8(0x11f)][_0x5e74b8(0x15c)]),_0x1bedf2=Texture2D[_0x5e74b8(0x133)](_0x4b9d67['view']['textureAlpha']);for(let _0x4cb6aa=0x0;_0x4cb6aa<_0x4b9d67['cleObjectArray']['length'];++_0x4cb6aa){let _0x3d16d6=_0x4b9d67['cleObjectArray'][_0x4cb6aa],_0x174fc0=_0x4b9d67[_0x5e74b8(0x128)][_0x4cb6aa];if(_0x174fc0!=null&&_0x174fc0['_arrKeyFrameData']['length']>0x0)CalculateObjectWldMatrix(0x0,_0x174fc0,_0x3d16d6[_0x5e74b8(0x13f)],_0x3d16d6[_0x5e74b8(0x146)],_0xaff8c),_0x4b9d67[_0x5e74b8(0x134)][_0x4cb6aa]=a81_0x29a196[_0x5e74b8(0x129)](_0x4b9d67['vWorldMatrixArray'][_0x4cb6aa],_0xaff8c),_0x4b9d67[_0x5e74b8(0x13a)][_0x4cb6aa]=a81_0x53edc2[_0x5e74b8(0x140)](_0x4b9d67[_0x5e74b8(0x13a)][_0x4cb6aa],_0x4b9d67['vWorldMatrixArray'][_0x4cb6aa]);else{let _0x45e2ed=a81_0x29a196[_0x5e74b8(0x129)](null,_0x3d16d6['_matLocal']),_0x406e9a=a81_0x29a196[_0x5e74b8(0x129)](null,_0x3d16d6[_0x5e74b8(0x146)]);_0x4b9d67[_0x5e74b8(0x134)][_0x4cb6aa]=a81_0x53edc2[_0x5e74b8(0x12c)](_0x4b9d67[_0x5e74b8(0x134)][_0x4cb6aa],_0x45e2ed,_0x406e9a),_0x4b9d67[_0x5e74b8(0x13a)][_0x4cb6aa]=a81_0x53edc2[_0x5e74b8(0x140)](_0x4b9d67[_0x5e74b8(0x13a)][_0x4cb6aa],_0x4b9d67[_0x5e74b8(0x134)][_0x4cb6aa]);}_0x174fc0!=null&&_0x174fc0[_0x5e74b8(0x14c)]['length']>0x0&&(_0x4b9d67[_0x5e74b8(0x151)][_0x4cb6aa]=CalculateObjectNoTransparency(0x0,_0x174fc0)),a81_0x53edc2[_0x5e74b8(0x160)](_0x4b9d67['vWorldMatrixArray'][_0x4cb6aa],_0x168175,_0x4cb6aa*0xc),a81_0x53edc2[_0x5e74b8(0x160)](_0x4b9d67[_0x5e74b8(0x13a)][_0x4cb6aa],_0x1cfa80,_0x4cb6aa*0xc),_0x1bedf2[_0x4cb6aa]=_0x4b9d67['vAlphaArray'][_0x4cb6aa],populateMeshObjectView(_0x4b9d67,_0x4cb6aa);}Texture2D[_0x5e74b8(0x12a)](_0x4b9d67['view'][_0x5e74b8(0x152)]),Texture2D[_0x5e74b8(0x12a)](_0x4b9d67[_0x5e74b8(0x11f)]['textureWorldIT']),Texture2D[_0x5e74b8(0x12a)](_0x4b9d67[_0x5e74b8(0x11f)][_0x5e74b8(0x15b)]),uploadMeshObjectView(_0x4b9d67);}export function updateWorldMatrixAndAlpha(_0xdc87a1,_0x2ba452,_0x31a2d5){const _0x16e40f=a81_0x5a78;if(_0xdc87a1[_0x16e40f(0x127)]!=_0x31a2d5){resetMeshObjectView(_0xdc87a1);let _0x2744a0=new ADF_BASEMATRIX(),_0x460343=Texture2D[_0x16e40f(0x133)](_0xdc87a1[_0x16e40f(0x11f)][_0x16e40f(0x152)]),_0x53ff9f=Texture2D[_0x16e40f(0x133)](_0xdc87a1['view'][_0x16e40f(0x15c)]),_0x521bf2=Texture2D[_0x16e40f(0x133)](_0xdc87a1[_0x16e40f(0x11f)][_0x16e40f(0x15b)]),_0x6fa354=![],_0x409d61=![];for(let _0x50fd13=0x0;_0x50fd13<_0xdc87a1['cleObjectArray'][_0x16e40f(0x13c)];++_0x50fd13){let _0x1cfce1=_0xdc87a1[_0x16e40f(0x147)][_0x50fd13],_0x20a62c=_0xdc87a1['cleObjAnimationArray'][_0x50fd13];_0x20a62c!=null&&(_0x20a62c[_0x16e40f(0x13d)][_0x16e40f(0x13c)]>0x0&&(CalculateObjectWldMatrix(_0x2ba452,_0x20a62c,_0x1cfce1[_0x16e40f(0x13f)],_0x1cfce1[_0x16e40f(0x146)],_0x2744a0),_0xdc87a1[_0x16e40f(0x134)][_0x50fd13]=a81_0x29a196[_0x16e40f(0x129)](_0xdc87a1[_0x16e40f(0x134)][_0x50fd13],_0x2744a0),_0xdc87a1[_0x16e40f(0x13a)][_0x50fd13]=a81_0x53edc2[_0x16e40f(0x140)](_0xdc87a1[_0x16e40f(0x13a)][_0x50fd13],_0xdc87a1[_0x16e40f(0x134)][_0x50fd13]),a81_0x53edc2[_0x16e40f(0x160)](_0xdc87a1[_0x16e40f(0x134)][_0x50fd13],_0x460343,_0x50fd13*0xc),a81_0x53edc2[_0x16e40f(0x160)](_0xdc87a1[_0x16e40f(0x13a)][_0x50fd13],_0x53ff9f,_0x50fd13*0xc),_0x6fa354=!![]),_0x20a62c[_0x16e40f(0x14c)][_0x16e40f(0x13c)]>0x0&&(_0xdc87a1[_0x16e40f(0x151)][_0x50fd13]=CalculateObjectNoTransparency(_0x2ba452,_0x20a62c),_0x521bf2[_0x50fd13]=_0xdc87a1['vAlphaArray'][_0x50fd13],_0x409d61=!![])),populateMeshObjectView(_0xdc87a1,_0x50fd13);}_0x6fa354&&(Texture2D[_0x16e40f(0x12a)](_0xdc87a1[_0x16e40f(0x11f)]['textureWorld']),Texture2D[_0x16e40f(0x12a)](_0xdc87a1[_0x16e40f(0x11f)][_0x16e40f(0x15c)])),_0x409d61&&(Texture2D[_0x16e40f(0x12a)](_0xdc87a1['view'][_0x16e40f(0x15b)]),uploadMeshObjectView(_0xdc87a1)),_0xdc87a1[_0x16e40f(0x127)]=_0x31a2d5;}}export function updateBounds(_0x187d67,_0x283113){const _0x4003f8=a81_0x5a78;let _0x2ba2af=a81_0x40e804[_0x4003f8(0x157)]();for(const _0x295398 of _0x187d67[_0x4003f8(0x134)]){_0x2ba2af=a81_0x40e804[_0x4003f8(0x12f)](_0x2ba2af,_0x187d67[_0x4003f8(0x148)],_0x295398),_0x283113=a81_0x40e804[_0x4003f8(0x132)](_0x283113,_0x283113,_0x2ba2af);}}function makeView(_0x40497d,_0x2e85e8,_0x269769){const _0x107c8d=a81_0x5a78;let _0x3e3b8c={'textureWorld':Texture2D[_0x107c8d(0x153)](_0x40497d,0x4,_0x2e85e8*0x3),'textureWorldIT':Texture2D[_0x107c8d(0x153)](_0x40497d,0x4,_0x2e85e8*0x3),'textureAlpha':Texture2D['createForFloatArray'](_0x40497d,0x1,_0x2e85e8),'textureMaterialPos':Texture2D[_0x107c8d(0x153)](_0x40497d,0x1,_0x2e85e8*_0x269769)};return _0x3e3b8c;}function resetMeshObjectView(_0x136b75){const _0x4ca5bb=a81_0x5a78;resetObjectView(_0x136b75[_0x4ca5bb(0x122)]),resetObjectView(_0x136b75[_0x4ca5bb(0x13e)]);}function populateMeshObjectView(_0x4d3552,_0x29455b){const _0x3c26bc=a81_0x5a78,_0x13ca2f=_0x4d3552[_0x3c26bc(0x151)][_0x29455b];if(_0x13ca2f>=0.001){let _0xadd4d2=![],_0x2efd5b=![];if(_0x13ca2f<0x1)_0x2efd5b=!![];else{const _0x1ba162=_0x4d3552['vFlagArray'][_0x29455b];_0xadd4d2=_0x1ba162<=0x0,_0x2efd5b=_0x1ba162>=0x0;}_0xadd4d2&&populateObjectView(_0x4d3552['solidView'],_0x29455b),_0x2efd5b&&populateObjectView(_0x4d3552['transparentView'],_0x29455b);}}function uploadMeshObjectView(_0x2c2791){const _0x5941af=a81_0x5a78;uploadObjectView(_0x2c2791[_0x5941af(0x122)]),uploadObjectView(_0x2c2791[_0x5941af(0x13e)]);}function makeObjectView(_0x49d725,_0x222303){const _0x5ceea0=a81_0x5a78;let _0x5104c3={'uObjCount':0x0,'textureObjPos':Texture2D[_0x5ceea0(0x153)](_0x49d725,0x1,_0x222303)};return _0x5104c3;}function resetObjectView(_0x1cb1a3){const _0x74a0e6=a81_0x5a78;_0x1cb1a3[_0x74a0e6(0x12b)]=0x0;}function populateObjectView(_0x1b6a00,_0x36f575){const _0x1d8c83=a81_0x5a78;let _0x255249=Texture2D[_0x1d8c83(0x133)](_0x1b6a00[_0x1d8c83(0x123)]);{_0x255249[_0x1b6a00[_0x1d8c83(0x12b)]]=_0x36f575;}_0x1b6a00['uObjCount']++;}function uploadObjectView(_0x36ad66){const _0xef4cec=a81_0x5a78;Texture2D[_0xef4cec(0x12a)](_0x36ad66[_0xef4cec(0x123)]);}function updateObjSubsetView(_0x5f0d6a,_0x5f32e8){const _0x2fa0d1=a81_0x5a78;let _0x1a9ca7=Texture2D[_0x2fa0d1(0x133)](_0x5f0d6a[_0x2fa0d1(0x11f)][_0x2fa0d1(0x145)]),_0x845744=_0x5f0d6a[_0x2fa0d1(0x124)]['_stuModelData'][_0x2fa0d1(0x15f)][_0x2fa0d1(0x13c)];for(let _0x5612e4=0x0;_0x5612e4<_0x5f0d6a['cleObjectArray'][_0x2fa0d1(0x13c)];++_0x5612e4){const _0x4d03b6=_0x5f0d6a[_0x2fa0d1(0x147)][_0x5612e4];let _0x407f97=0x0;for(let _0x25fd09=0x0;_0x25fd09<_0x845744;++_0x25fd09){if(_0x25fd09<_0x4d03b6[_0x2fa0d1(0x150)][_0x2fa0d1(0x13c)]){const _0xeb2ec9=_0x4d03b6[_0x2fa0d1(0x150)][_0x25fd09],_0x4bfe4f=_0x5f32e8[_0xeb2ec9];_0x407f97=_0x4bfe4f[_0x2fa0d1(0x125)];}_0x1a9ca7[_0x5612e4*_0x845744+_0x25fd09]=_0x407f97;}}Texture2D[_0x2fa0d1(0x12a)](_0x5f0d6a[_0x2fa0d1(0x11f)]['textureMaterialPos']);}