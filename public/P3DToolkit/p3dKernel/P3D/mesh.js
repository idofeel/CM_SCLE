'use strict';const a88_0x5692=['length','cleObjAnimationArray','_uStartIndex','_matLocal','getArrayData','_arrKeyFrameData','126188ubQYRe','12JeOruw','_stuModelData','2yGlFTm','push','iBuffer','createStaticVertexBuffer','688724XdBjcE','LogicError','mul','createStaticIndexBuffer','invalid\x20material\x20index\x20','_uObjectID','textureWorldIT','cleObjectArray','textureAlpha','solidView','_uIndexCount','_arrSubset','vFlagArray','cleModel','_uModelID','make','_nFillMode','vWorldMatrixArray','toTextureFloatArray','merge','uploadArrayData','uObjCount','uWorldAlphaRevision','_uIsUV','textureObjPos','vBuffer','_uMeshID','textureWorld','inverseTranspose','71741hxZGHF','uPos','_arrVertexData','vAlphaArray','_matWorld','xyz<n','_box','_arrSubsetMtlID','vWorldITMatrixArray','_arrTranspKeyFrm','254708XuVRkx','vSubsetBuffer','bounds','transparentView','createForFloatArray','34751jhyaRD','_arrIndexData','alpha','fromCleMatrix','711558xSNhtt','fromCleBox','textureMaterialPos','bContainUV','fill','608547fzRCzY','view'];(function(_0x26694c,_0xd010e7){const _0x2b9f4d=a88_0x7b36;while(!![]){try{const _0x230d48=-parseInt(_0x2b9f4d(0x210))+-parseInt(_0x2b9f4d(0x1e2))+parseInt(_0x2b9f4d(0x1e3))*parseInt(_0x2b9f4d(0x206))+parseInt(_0x2b9f4d(0x21e))+parseInt(_0x2b9f4d(0x219))+parseInt(_0x2b9f4d(0x215))+parseInt(_0x2b9f4d(0x1e9))*-parseInt(_0x2b9f4d(0x1e5));if(_0x230d48===_0xd010e7)break;else _0x26694c['push'](_0x26694c['shift']());}catch(_0x17c2ef){_0x26694c['push'](_0x26694c['shift']());}}}(a88_0x5692,0x6fabc));import*as a88_0x5c4797 from'../Math/math.js';import*as a88_0x1f1bbe from'../Math/matrix.js';import*as a88_0x2b4505 from'../Math/box.js';import*as a88_0x7b811 from'./comm.js';export function from(_0x2e9c46,_0x546416,_0x389660,_0x218a6c,_0x859b09){const _0x1f4134=a88_0x7b36;let _0x3570a4={'uIndex':_0x546416[_0x1f4134(0x1f7)],'cleModel':_0x546416,'bounds':a88_0x7b811[_0x1f4134(0x21a)](null,_0x546416[_0x1f4134(0x1e4)][_0x1f4134(0x20c)]),'bContainUV':![],'cleObjectArray':new Array(),'cleObjAnimationArray':new Array(),'vFlagArray':new Array(),'vWorldMatrixArray':null,'vWorldITMatrixArray':null,'vAlphaArray':null,'vBuffer':null,'vSubsetBuffer':null,'iBuffer':null,'view':null,'solidView':null,'transparentView':null,'uWorldAlphaRevision':0x0},_0x12fdde=_0x546416['_stuModelData'];_0x3570a4[_0x1f4134(0x21c)]=_0x12fdde[_0x1f4134(0x200)]===0x1,_0x3570a4[_0x1f4134(0x202)]=Buffer[_0x1f4134(0x1e8)](_0x2e9c46,_0x12fdde['_arrVertexData'],_0x3570a4[_0x1f4134(0x21c)]?'xyz<n<uv':_0x1f4134(0x20b)),_0x3570a4[_0x1f4134(0x211)]=buildVertexSubsetIndex(_0x2e9c46,_0x546416),_0x3570a4[_0x1f4134(0x1e7)]=Buffer[_0x1f4134(0x1ec)](_0x2e9c46,_0x12fdde['_arrIndexData']);const _0x2cd62c=_0x3570a4['uIndex'];for(const _0x167e9a of _0x389660['_arrObjSaveData']){if(_0x167e9a[_0x1f4134(0x1f9)]!=ADFFILL_SOLID)continue;if(_0x167e9a[_0x1f4134(0x203)]==_0x2cd62c){let _0x5cab03=computeSubsetFlag(_0x546416,_0x167e9a,_0x859b09);_0x3570a4[_0x1f4134(0x1f0)][_0x1f4134(0x1e6)](_0x167e9a),_0x3570a4['cleObjAnimationArray'][_0x1f4134(0x1e6)](_0x218a6c[_0x167e9a[_0x1f4134(0x1ee)]]),_0x3570a4[_0x1f4134(0x1f5)][_0x1f4134(0x1e6)](_0x5cab03);}}return _0x3570a4[_0x1f4134(0x1fa)]=new Array(_0x3570a4[_0x1f4134(0x1f0)]['length']),_0x3570a4[_0x1f4134(0x20e)]=new Array(_0x3570a4[_0x1f4134(0x1f0)][_0x1f4134(0x220)]),_0x3570a4[_0x1f4134(0x209)]=new Array(_0x3570a4['cleObjectArray'][_0x1f4134(0x220)])[_0x1f4134(0x21d)](0x1),_0x3570a4['view']=makeView(_0x2e9c46,_0x3570a4[_0x1f4134(0x1f0)][_0x1f4134(0x220)],_0x546416[_0x1f4134(0x1e4)][_0x1f4134(0x1f4)][_0x1f4134(0x220)]),_0x3570a4['solidView']=makeObjectView(_0x2e9c46,_0x3570a4[_0x1f4134(0x1f0)][_0x1f4134(0x220)]),_0x3570a4[_0x1f4134(0x213)]=makeObjectView(_0x2e9c46,_0x3570a4[_0x1f4134(0x1f0)][_0x1f4134(0x220)]),initWorldMatrixAndAlpha(_0x3570a4),updateObjSubsetView(_0x3570a4,_0x859b09),_0x3570a4;}function buildVertexSubsetIndex(_0x5b8a04,_0x4d372a){const _0x2041a0=a88_0x7b36;let _0x4d52f5=_0x4d372a[_0x2041a0(0x1e4)],_0xd998ff=new Array(_0x4d52f5[_0x2041a0(0x208)][_0x2041a0(0x220)]/(_0x4d52f5[_0x2041a0(0x200)]===0x1?0x8:0x6));if(_0x4d372a[_0x2041a0(0x1e4)][_0x2041a0(0x1f4)][_0x2041a0(0x220)]>0x1)for(let _0x173617=0x0;_0x173617<_0x4d372a[_0x2041a0(0x1e4)][_0x2041a0(0x1f4)][_0x2041a0(0x220)];++_0x173617){let _0x2794be=_0x4d372a[_0x2041a0(0x1e4)][_0x2041a0(0x1f4)][_0x173617][_0x2041a0(0x1de)],_0x37cb41=_0x4d372a[_0x2041a0(0x1e4)]['_arrSubset'][_0x173617][_0x2041a0(0x1f3)];for(let _0x41f329=0x0;_0x41f329<_0x37cb41;++_0x41f329){let _0x259bf3=_0x2794be+_0x41f329,_0x24ebaa=_0x4d52f5[_0x2041a0(0x216)][_0x259bf3];_0xd998ff[_0x24ebaa]=_0x173617;}}else _0xd998ff['fill'](0x0);return Buffer[_0x2041a0(0x1e8)](_0x5b8a04,new Float32Array(_0xd998ff),'i1');}function computeSubsetFlag(_0x4142cd,_0x309302,_0x5bdcd7){const _0x39b0fa=a88_0x7b36;let _0xb47c74=0x0;if(_0x4142cd[_0x39b0fa(0x1e4)][_0x39b0fa(0x1f4)][_0x39b0fa(0x220)]>0x1&&_0x4142cd[_0x39b0fa(0x1e4)]['_arrSubset'][_0x39b0fa(0x220)]==_0x309302[_0x39b0fa(0x20d)][_0x39b0fa(0x220)]){let _0x4fefcd=0x0,_0x3c7380=0x0;for(let _0x34ef51=0x0;_0x34ef51<_0x309302['_arrSubsetMtlID'][_0x39b0fa(0x220)];++_0x34ef51){let _0x8ebbf9=_0x309302['_arrSubsetMtlID'][_0x34ef51],_0x48a80f=_0x5bdcd7[_0x8ebbf9];if(_0x48a80f==null)throw new error[(_0x39b0fa(0x1ea))](_0x39b0fa(0x1ed)+_0x8ebbf9);_0x48a80f[_0x39b0fa(0x217)]<0x1?_0x3c7380++:_0x4fefcd++;}if(_0x4fefcd==_0x309302[_0x39b0fa(0x20d)][_0x39b0fa(0x220)])_0xb47c74=-0x1;else _0x3c7380==_0x309302['_arrSubsetMtlID'][_0x39b0fa(0x220)]&&(_0xb47c74=0x1);}else{let _0x2046ff=0x0;_0x309302[_0x39b0fa(0x20d)][_0x39b0fa(0x220)]>0x0&&(_0x2046ff=_0x309302[_0x39b0fa(0x20d)][0x0]);let _0x388a84=_0x5bdcd7[_0x2046ff];if(_0x388a84==null)throw new error[(_0x39b0fa(0x1ea))](_0x39b0fa(0x1ed)+_0x2046ff);_0xb47c74=_0x388a84[_0x39b0fa(0x217)]<0x1?0x1:-0x1;}return _0xb47c74;}export function initWorldMatrixAndAlpha(_0x562d44){const _0x645e12=a88_0x7b36;resetMeshObjectView(_0x562d44);let _0x33a4e1=new ADF_BASEMATRIX(),_0x2a154a=Texture2D[_0x645e12(0x1e0)](_0x562d44['view'][_0x645e12(0x204)]),_0x1d907e=Texture2D['getArrayData'](_0x562d44['view'][_0x645e12(0x1ef)]),_0x1b893e=Texture2D[_0x645e12(0x1e0)](_0x562d44[_0x645e12(0x21f)][_0x645e12(0x1f1)]);for(let _0x102897=0x0;_0x102897<_0x562d44[_0x645e12(0x1f0)]['length'];++_0x102897){let _0x5e98ed=_0x562d44[_0x645e12(0x1f0)][_0x102897],_0x25bee7=_0x562d44[_0x645e12(0x1dd)][_0x102897];if(_0x25bee7!=null&&_0x25bee7[_0x645e12(0x1e1)][_0x645e12(0x220)]>0x0)CalculateObjectWldMatrix(0x0,_0x25bee7,_0x5e98ed[_0x645e12(0x1df)],_0x5e98ed['_matWorld'],_0x33a4e1),_0x562d44[_0x645e12(0x1fa)][_0x102897]=a88_0x7b811[_0x645e12(0x218)](_0x562d44[_0x645e12(0x1fa)][_0x102897],_0x33a4e1),_0x562d44[_0x645e12(0x20e)][_0x102897]=a88_0x1f1bbe[_0x645e12(0x205)](_0x562d44[_0x645e12(0x20e)][_0x102897],_0x562d44[_0x645e12(0x1fa)][_0x102897]);else{let _0x38a5cc=a88_0x7b811[_0x645e12(0x218)](null,_0x5e98ed[_0x645e12(0x1df)]),_0x5c7c3e=a88_0x7b811['fromCleMatrix'](null,_0x5e98ed[_0x645e12(0x20a)]);_0x562d44[_0x645e12(0x1fa)][_0x102897]=a88_0x1f1bbe[_0x645e12(0x1eb)](_0x562d44[_0x645e12(0x1fa)][_0x102897],_0x38a5cc,_0x5c7c3e),_0x562d44[_0x645e12(0x20e)][_0x102897]=a88_0x1f1bbe[_0x645e12(0x205)](_0x562d44[_0x645e12(0x20e)][_0x102897],_0x562d44[_0x645e12(0x1fa)][_0x102897]);}_0x25bee7!=null&&_0x25bee7[_0x645e12(0x20f)]['length']>0x0&&(_0x562d44[_0x645e12(0x209)][_0x102897]=CalculateObjectNoTransparency(0x0,_0x25bee7)),a88_0x1f1bbe[_0x645e12(0x1fb)](_0x562d44[_0x645e12(0x1fa)][_0x102897],_0x2a154a,_0x102897*0xc),a88_0x1f1bbe['toTextureFloatArray'](_0x562d44[_0x645e12(0x20e)][_0x102897],_0x1d907e,_0x102897*0xc),_0x1b893e[_0x102897]=_0x562d44[_0x645e12(0x209)][_0x102897],populateMeshObjectView(_0x562d44,_0x102897);}Texture2D[_0x645e12(0x1fd)](_0x562d44[_0x645e12(0x21f)][_0x645e12(0x204)]),Texture2D[_0x645e12(0x1fd)](_0x562d44[_0x645e12(0x21f)][_0x645e12(0x1ef)]),Texture2D[_0x645e12(0x1fd)](_0x562d44['view'][_0x645e12(0x1f1)]),uploadMeshObjectView(_0x562d44);}export function updateWorldMatrixAndAlpha(_0x20be87,_0x560dca,_0x20e406){const _0x5dacc4=a88_0x7b36;if(_0x20be87['uWorldAlphaRevision']!=_0x20e406){resetMeshObjectView(_0x20be87);let _0x25e6d5=new ADF_BASEMATRIX(),_0x21a4d5=Texture2D['getArrayData'](_0x20be87['view'][_0x5dacc4(0x204)]),_0x13a5e7=Texture2D['getArrayData'](_0x20be87[_0x5dacc4(0x21f)][_0x5dacc4(0x1ef)]),_0x5540c7=Texture2D[_0x5dacc4(0x1e0)](_0x20be87[_0x5dacc4(0x21f)][_0x5dacc4(0x1f1)]),_0x4a55c2=![],_0x3a7659=![];for(let _0xa41d29=0x0;_0xa41d29<_0x20be87[_0x5dacc4(0x1f0)][_0x5dacc4(0x220)];++_0xa41d29){let _0x6f621a=_0x20be87[_0x5dacc4(0x1f0)][_0xa41d29],_0x213854=_0x20be87[_0x5dacc4(0x1dd)][_0xa41d29];_0x213854!=null&&(_0x213854[_0x5dacc4(0x1e1)]['length']>0x0&&(CalculateObjectWldMatrix(_0x560dca,_0x213854,_0x6f621a['_matLocal'],_0x6f621a[_0x5dacc4(0x20a)],_0x25e6d5),_0x20be87[_0x5dacc4(0x1fa)][_0xa41d29]=a88_0x7b811[_0x5dacc4(0x218)](_0x20be87[_0x5dacc4(0x1fa)][_0xa41d29],_0x25e6d5),_0x20be87[_0x5dacc4(0x20e)][_0xa41d29]=a88_0x1f1bbe[_0x5dacc4(0x205)](_0x20be87[_0x5dacc4(0x20e)][_0xa41d29],_0x20be87[_0x5dacc4(0x1fa)][_0xa41d29]),a88_0x1f1bbe[_0x5dacc4(0x1fb)](_0x20be87[_0x5dacc4(0x1fa)][_0xa41d29],_0x21a4d5,_0xa41d29*0xc),a88_0x1f1bbe[_0x5dacc4(0x1fb)](_0x20be87[_0x5dacc4(0x20e)][_0xa41d29],_0x13a5e7,_0xa41d29*0xc),_0x4a55c2=!![]),_0x213854['_arrTranspKeyFrm']['length']>0x0&&(_0x20be87[_0x5dacc4(0x209)][_0xa41d29]=CalculateObjectNoTransparency(_0x560dca,_0x213854),_0x5540c7[_0xa41d29]=_0x20be87[_0x5dacc4(0x209)][_0xa41d29],_0x3a7659=!![])),populateMeshObjectView(_0x20be87,_0xa41d29);}_0x4a55c2&&(Texture2D['uploadArrayData'](_0x20be87[_0x5dacc4(0x21f)][_0x5dacc4(0x204)]),Texture2D[_0x5dacc4(0x1fd)](_0x20be87['view'][_0x5dacc4(0x1ef)])),_0x3a7659&&(Texture2D[_0x5dacc4(0x1fd)](_0x20be87['view'][_0x5dacc4(0x1f1)]),uploadMeshObjectView(_0x20be87)),_0x20be87[_0x5dacc4(0x1ff)]=_0x20e406;}}export function updateBounds(_0x590738,_0x40a545){const _0x5a1e1b=a88_0x7b36;let _0x2154d4=a88_0x2b4505[_0x5a1e1b(0x1f8)]();for(const _0x3ff064 of _0x590738[_0x5a1e1b(0x1fa)]){_0x2154d4=a88_0x2b4505['transform'](_0x2154d4,_0x590738[_0x5a1e1b(0x212)],_0x3ff064),_0x40a545=a88_0x2b4505[_0x5a1e1b(0x1fc)](_0x40a545,_0x40a545,_0x2154d4);}}function makeView(_0x2d3999,_0x124970,_0x45ae85){const _0x4d0e56=a88_0x7b36;let _0x3fe738={'textureWorld':Texture2D[_0x4d0e56(0x214)](_0x2d3999,0x4,_0x124970*0x3),'textureWorldIT':Texture2D[_0x4d0e56(0x214)](_0x2d3999,0x4,_0x124970*0x3),'textureAlpha':Texture2D[_0x4d0e56(0x214)](_0x2d3999,0x1,_0x124970),'textureMaterialPos':Texture2D[_0x4d0e56(0x214)](_0x2d3999,0x1,_0x124970*_0x45ae85)};return _0x3fe738;}function resetMeshObjectView(_0x212691){const _0x313aac=a88_0x7b36;resetObjectView(_0x212691[_0x313aac(0x1f2)]),resetObjectView(_0x212691[_0x313aac(0x213)]);}function populateMeshObjectView(_0xe075d7,_0x159d75){const _0x567ef8=a88_0x7b36,_0x540ad9=_0xe075d7[_0x567ef8(0x209)][_0x159d75];if(_0x540ad9>=0.001){let _0x2fb672=![],_0x46fcb9=![];if(_0x540ad9<0x1)_0x46fcb9=!![];else{const _0x480ed0=_0xe075d7[_0x567ef8(0x1f5)][_0x159d75];_0x2fb672=_0x480ed0<=0x0,_0x46fcb9=_0x480ed0>=0x0;}_0x2fb672&&populateObjectView(_0xe075d7[_0x567ef8(0x1f2)],_0x159d75),_0x46fcb9&&populateObjectView(_0xe075d7['transparentView'],_0x159d75);}}function uploadMeshObjectView(_0x1364b9){const _0x14ef15=a88_0x7b36;uploadObjectView(_0x1364b9[_0x14ef15(0x1f2)]),uploadObjectView(_0x1364b9[_0x14ef15(0x213)]);}function a88_0x7b36(_0x1d539b,_0x4e2b84){_0x1d539b=_0x1d539b-0x1dd;let _0x569262=a88_0x5692[_0x1d539b];return _0x569262;}function makeObjectView(_0xad4475,_0x3963c8){const _0x54b41b=a88_0x7b36;let _0x3e9ff8={'uObjCount':0x0,'textureObjPos':Texture2D[_0x54b41b(0x214)](_0xad4475,0x1,_0x3963c8)};return _0x3e9ff8;}function resetObjectView(_0x3efcea){const _0x42929f=a88_0x7b36;_0x3efcea[_0x42929f(0x1fe)]=0x0;}function populateObjectView(_0x3b0091,_0xec2e02){const _0xfb58b1=a88_0x7b36;let _0x381aee=Texture2D[_0xfb58b1(0x1e0)](_0x3b0091[_0xfb58b1(0x201)]);{_0x381aee[_0x3b0091[_0xfb58b1(0x1fe)]]=_0xec2e02;}_0x3b0091['uObjCount']++;}function uploadObjectView(_0x38cc76){const _0x2e7bb6=a88_0x7b36;Texture2D[_0x2e7bb6(0x1fd)](_0x38cc76[_0x2e7bb6(0x201)]);}function updateObjSubsetView(_0x4c0655,_0x4d8514){const _0xb032f1=a88_0x7b36;let _0x153ee9=Texture2D[_0xb032f1(0x1e0)](_0x4c0655[_0xb032f1(0x21f)][_0xb032f1(0x21b)]),_0xabfbd9=_0x4c0655[_0xb032f1(0x1f6)][_0xb032f1(0x1e4)][_0xb032f1(0x1f4)]['length'];for(let _0x131527=0x0;_0x131527<_0x4c0655[_0xb032f1(0x1f0)]['length'];++_0x131527){const _0x156c0f=_0x4c0655[_0xb032f1(0x1f0)][_0x131527];let _0x472f32=0x0;for(let _0x28b922=0x0;_0x28b922<_0xabfbd9;++_0x28b922){if(_0x28b922<_0x156c0f['_arrSubsetMtlID'][_0xb032f1(0x220)]){const _0xbe68fe=_0x156c0f[_0xb032f1(0x20d)][_0x28b922],_0x366c33=_0x4d8514[_0xbe68fe];_0x472f32=_0x366c33[_0xb032f1(0x207)];}_0x153ee9[_0x131527*_0xabfbd9+_0x28b922]=_0x472f32;}}Texture2D[_0xb032f1(0x1fd)](_0x4c0655[_0xb032f1(0x21f)][_0xb032f1(0x21b)]);}